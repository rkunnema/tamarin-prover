theory OPC_UA_Secure_Communication begin

// Function signature and definition of the equational theory E

builtins: multiset
functions: fst/1, h/1, mac/2, pair/2, sdec/2, senc/2, snd/1, true/0,
           verifyMac/3
equations:
    fst(<x.1, x.2>) = x.1,
    sdec(senc(x.1, x.2), x.2) = x.1,
    snd(<x.1, x.2>) = x.2,
    verifyMac(mac(m, sk), m, sk) = true



heuristic: p

section{* The OPC UA Secure Conversation protocol *}















restriction A_Counter_Increases:
  "∀ A B seq1 seq2 #i #j.
    (((Seq_Sent( A, B, seq1 ) @ #i) ∧ (Seq_Sent( A, B, seq2 ) @ #j)) ∧
     (#i < #j)) ⇒
    (∃ dif. seq2 = (dif++seq1))"

restriction A_Counter_No_Reuse:
  "∀ A B seq #i #j.
    ((Seq_Sent( A, B, seq ) @ #i) ∧ (Seq_Sent( A, B, seq ) @ #j)) ⇒
    (#i = #j)"
  // safety formula

restriction B_Counter_Counter_Increases:
  "∀ A B seq1 seq2 #i #j.
    (((Seq_Recv( A, B, seq1 ) @ #i) ∧ (Seq_Recv( A, B, seq2 ) @ #j)) ∧
     (#i < #j)) ⇒
    (∃ dif. seq2 = (dif++seq1))"

restriction B_Counter_No_Reuse:
  "∀ A B seq #i #j.
    ((Seq_Recv( A, B, seq ) @ #i) ∧ (Seq_Recv( A, B, seq ) @ #j)) ⇒
    (#i = #j)"
  // safety formula

lemma Executable:
  exists-trace "∃ A B m #i. Recv( A, B, m ) @ #i"
/*
guarded formula characterizing all satisfying traces:
"∃ A B m #i. (Recv( A, B, m ) @ #i)"
*/
simplify
solve( State_111112111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH,
                           SH, A, B, kEnc, kSign, lock, pad, xmac, m, seq
       ) ▶₀ #i )
  case eventSeqRecvabseq_0_11111211111
  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.1 )
    case p_1_
    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.2 )
      case p_1_
      solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
             ) ▶₀ #t.3 )
        case p_1_1111121
        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
          case p_1_
          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
            case p_1_
            solve( (∃ #t. (ProgressTo_11111211111111( ~prog_1111121111 ) @ #t))  ∥
                   (∃ #t. (ProgressTo_11111211112( ~prog_1111121111 ) @ #t)) )
              case case_1
              solve( State_1111121111111( ~prog_1.1, ~prog_11111211.1,
                                          ~prog_1111121111, MH.1, SH.1, a, b, kEnc, kSign, lock, pad.1, xmac,
                                          m.1, seq.1
                     ) ▶₀ #t.4 )
                case eventRecvabm_0_111112111111
                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                  case p_1_
                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                    case p_1_
                    solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
                           ) ▶₀ #t.5 )
                      case p_1_1111121
                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                        case p_1_
                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                          case p_1_
                          solve( !KU( senc(<seq, m, pad, mac(<MH, SH, seq, m, pad>, ~n.3)>, ~n.2)
                                 ) @ #vk.4 )
                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                            solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j )
                              case MessageIDRule
                              solve( State_111112111( ~prog_1.1, ~prog_11111211.1, a, b, ~n.2, kSign,
                                                      lock
                                     ) ▶₁ #j )
                                case lockba_0_11111211
                                solve( ((#t.3 < #vr.15) ∧
                                        (∃ #t2.
                                          (Unlock_1( '1', ~n.4, <~n.1, ~n> ) @ #t2)
                                         ∧
                                          (#t.3 < #t2) ∧
                                          (#t2 < #vr.15) ∧
                                          (∀ #t0 pp. (Unlock( pp, ~n.4, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                                          (∀ pp lpp #t0.
                                            (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                           ⇒
                                            ((#t0 < #t.3) ∨ (#t0 = #t.3) ∨ (#t2 < #t0))) ∧
                                          (∀ pp lpp #t0.
                                            (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                           ⇒
                                            ((#t0 < #t.3) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                       (#vr.15 < #t.3)  ∥ (#t.3 = #vr.15) )
                                  case case_3
                                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                    case p_1_
                                    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                      case p_1_
                                      solve( State_11111111( ~prog_1.1, ~prog_11111111, a, b, kEnc, kSign
                                             ) ▶₀ #t.5 )
                                        case p_1_1111111
                                        solve( State_11111111111111( $MH.1, $SH.1, $pad.1, ~prog_1.1,
                                                                     ~prog_11111111.1, ~prog_1111111111, lock,
                                                                     a, b, kEnc, kSign, m, seq.1
                                               ) ▶₀ #t.6 )
                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                          solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j.1 )
                                            case MessageIDRule
                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.7 )
                                              case p_1_
                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.7 )
                                                case p_1_
                                                solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc,
                                                                       kSign
                                                       ) ▶₀ #t.7 )
                                                  case p_1_1111121
                                                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.7 )
                                                    case p_1_
                                                    solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                           ) ▶₀ #t.7 )
                                                      case p_1_
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.7 )
                                                        case p_1_
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t.7 )
                                                          case p_1_
                                                          solve( State_11111111( ~prog_1.1, ~prog_11111111, a,
                                                                                 b, kEnc, kSign
                                                                 ) ▶₀ #t.7 )
                                                            case p_1_1111111
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.7 )
                                                              case p_1_
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t.7 )
                                                                case p_1_
                                                                solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t.7 )
                                                                  case p_1_
                                                                  solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.7 )
                                                                    case p_1_
                                                                    SOLVED // trace found
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma all_received_were_sent:
  all-traces
  "∀ A B m #i.
    (Recv( A, B, m ) @ #i) ⇒ (∃ #k. (Sent( A, B, m ) @ #k) ∧ (#k < #i))"
/*
guarded formula characterizing all counter-examples:
"∃ A B m #i.
  (Recv( A, B, m ) @ #i) ∧ ∀ #k. (Sent( A, B, m ) @ #k) ⇒ ¬(#k < #i)"
*/
simplify
solve( State_111112111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH,
                           SH, A, B, kEnc, kSign, lock, pad, xmac, m, seq
       ) ▶₀ #i )
  case eventSeqRecvabseq_0_11111211111
  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.1 )
    case p_1_
    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.2 )
      case p_1_
      solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
             ) ▶₀ #t.3 )
        case p_1_1111121
        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
          case p_1_
          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
            case p_1_
            solve( (∃ #t. (ProgressTo_11111211111111( ~prog_1111121111 ) @ #t))  ∥
                   (∃ #t. (ProgressTo_11111211112( ~prog_1111121111 ) @ #t)) )
              case case_1
              solve( State_1111121111111( ~prog_1.1, ~prog_11111211.1,
                                          ~prog_1111121111, MH.1, SH.1, a, b, kEnc, kSign, lock, pad.1, xmac,
                                          m.1, seq.1
                     ) ▶₀ #t.4 )
                case eventRecvabm_0_111112111111
                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                  case p_1_
                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                    case p_1_
                    solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
                           ) ▶₀ #t.5 )
                      case p_1_1111121
                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                        case p_1_
                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                          case p_1_
                          solve( !KU( senc(<seq, m, pad, mac(<MH, SH, seq, m, pad>, ~n.3)>, ~n.2)
                                 ) @ #vk.4 )
                            case c_senc
                            by solve( !KU( ~n.2 ) @ #vk.6 )
                          next
                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              by solve( State_1111121111( ~prog_1.1, ~prog_11111211.1,
                                          ~prog_1111121111, MH.1, SH.1, a, b, kEnc, kSign, lock, pad.1, xmac,
                                          m.1, seq.1
                        ) ▶₀ #t.4 )
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma all_received_were_sent_injective:
  all-traces
  "∀ A B t #i.
    (Recv( A, B, t ) @ #i) ⇒
    (∃ #j.
      ((Sent( A, B, t ) @ #j) ∧ (#j < #i)) ∧
      (¬(∃ A2 B2 #i2. (Recv( A2, B2, t ) @ #i2) ∧ (¬(#i2 = #i)))))"
/*
guarded formula characterizing all counter-examples:
"∃ A B t #i.
  (Recv( A, B, t ) @ #i)
 ∧
  ∀ #j.
   (Sent( A, B, t ) @ #j)
  ⇒
   ((¬(#j < #i)) ∨ (∃ A2 B2 #i2. (Recv( A2, B2, t ) @ #i2) ∧ ¬(#i2 = #i)))"
*/
simplify
solve( State_111112111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH,
                           SH, A, B, kEnc, kSign, lock, pad, xmac, t, seq
       ) ▶₀ #i )
  case eventSeqRecvabseq_0_11111211111
  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.2 )
    case p_1_
    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.3 )
      case p_1_
      solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
             ) ▶₀ #t.4 )
        case p_1_1111121
        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
          case p_1_
          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
            case p_1_
            solve( (∃ #t. (ProgressTo_11111211111111( ~prog_1111121111 ) @ #t))  ∥
                   (∃ #t. (ProgressTo_11111211112( ~prog_1111121111 ) @ #t)) )
              case case_1
              solve( State_1111121111111( ~prog_1.1, ~prog_11111211.1,
                                          ~prog_1111121111, MH.1, SH.1, a, b, kEnc, kSign, lock, pad.1, xmac,
                                          m, seq.1
                     ) ▶₀ #t.4 )
                case eventRecvabm_0_111112111111
                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
                  case p_1_
                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
                    case p_1_
                    solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
                           ) ▶₀ #t.4 )
                      case p_1_1111121
                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
                        case p_1_
                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
                          case p_1_
                          solve( !KU( senc(<seq, m, pad, mac(<MH, SH, seq, m, pad>, ~n.3)>, ~n.2)
                                 ) @ #vk.4 )
                            case c_senc
                            by solve( !KU( ~n.2 ) @ #vk.6 )
                          next
                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                            solve( (#i2 < #i)  ∥ (#i < #i2) )
                              case case_1
                              solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j )
                                case MessageIDRule
                                solve( State_111112111( ~prog_1.2, ~prog_11111211.2, a, b, ~n.2, kSign.1,
                                                        lock.1
                                       ) ▶₁ #j )
                                  case lockba_0_11111211
                                  solve( ((#vr.3 < #vr.16) ∧
                                          (∃ #t2.
                                            (Unlock_1( '1', ~n.4, <~n.1, ~n> ) @ #t2)
                                           ∧
                                            (#vr.3 < #t2) ∧
                                            (#t2 < #vr.16) ∧
                                            (∀ #t0 pp. (Unlock( pp, ~n.4, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                                            (∀ pp lpp #t0.
                                              (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.3) ∨ (#t0 = #vr.3) ∨ (#t2 < #t0))) ∧
                                            (∀ pp lpp #t0.
                                              (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.3) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                         (#vr.16 < #vr.3)  ∥ (#vr.3 = #vr.16) )
                                    case case_1
                                    solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                      case p_1_
                                      solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                        case p_1_
                                        solve( State_11111111( ~prog_1.2, ~prog_11111111, a, b, kEnc.1,
                                                               kSign.1
                                               ) ▶₀ #t.4 )
                                          case p_1_1111111
                                          solve( State_11111111111111( $MH.2, $SH.2, $pad.2, ~prog_1.2,
                                                                       ~prog_11111111.1, ~prog_1111111111,
                                                                       lock.1, a, b, kEnc.1, kSign.1, m, seq.2
                                                 ) ▶₀ #t.5 )
                                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                            solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j.1 )
                                              case MessageIDRule
                                              solve( State_111112111111( ~prog_1.1, ~prog_11111211.1,
                                                                         ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                         B2, kEnc, kSign, lock, pad.1, xmac,
                                                                         ~n.5, seq.1
                                                     ) ▶₀ #i2 )
                                                case eventSeqRecvabseq_0_11111211111
                                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.6 )
                                                  case p_1_
                                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.6 )
                                                    case p_1_
                                                    solve( State_11111211( ~prog_1.2, ~prog_11111211.2, a, b,
                                                                           kEnc, kSign
                                                           ) ▶₀ #t.6 )
                                                      case p_1_1111121
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.7 )
                                                        case p_1_
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t.7 )
                                                          case p_1_
                                                          solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                 ) ▶₀ #t.7 )
                                                            case p_1_
                                                            solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.7 )
                                                              case p_1_
                                                              solve( State_11111111( ~prog_1.2,
                                                                                     ~prog_11111111, a, b,
                                                                                     kEnc, kSign
                                                                     ) ▶₀ #t.7 )
                                                                case p_1_1111111
                                                                solve( State_111111( ~prog_1.1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t.7 )
                                                                  case p_1_
                                                                  solve( State_111112( ~prog_1.1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.8 )
                                                                    case p_1_
                                                                    solve( State_11111211( ~prog_1.2,
                                                                                           ~prog_11111211.1,
                                                                                           a, b, kEnc, kSign
                                                                           ) ▶₀ #t.9 )
                                                                      case p_1_1111121
                                                                      solve( State_111111( ~prog_1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t.10 )
                                                                        case p_1_
                                                                        solve( State_111112( ~prog_1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t.10 )
                                                                          case p_1_
                                                                          solve( State_111111( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t.10 )
                                                                            case p_1_
                                                                            solve( State_111112( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t.10 )
                                                                              case p_1_
                                                                              solve( State_111111( ~prog_1.1,
                                                                                                   a, b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.10 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1.1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.10 )
                                                                                  case p_1_
                                                                                  solve( (∃ #t.
                                                                                           (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                            ) @ #t))  ∥
                                                                                         (∃ #t.
                                                                                           (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                            ) @ #t)) )
                                                                                    case case_1
                                                                                    solve( State_1111121111111( ~prog_1.2,
                                                                                                                ~prog_11111211.3,
                                                                                                                ~prog_1111121111.2,
                                                                                                                MH.2,
                                                                                                                SH.2,
                                                                                                                a,
                                                                                                                b,
                                                                                                                kEnc,
                                                                                                                kSign,
                                                                                                                lock,
                                                                                                                pad.2,
                                                                                                                xmac,
                                                                                                                m,
                                                                                                                seq.2
                                                                                           ) ▶₀ #t.10 )
                                                                                      case eventRecvabm_0_111112111111
                                                                                      by contradiction
                                                                                         /* cyclic */
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( State_1111121111( ~prog_1.2,
                                                                                                             ~prog_11111211.3,
                                                                                                             ~prog_1111121111.2,
                                                                                                             MH.2,
                                                                                                             SH.2,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign,
                                                                                                             lock,
                                                                                                             pad.2,
                                                                                                             xmac,
                                                                                                             m,
                                                                                                             seq.2
                                                                                           ) ▶₀ #t.10 )
                                                                                      case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_2
                                    solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                      case p_1_
                                      solve( State_111112( ~prog_1, a, b, kEnc.2, kSign.2 ) ▶₀ #t.4 )
                                        case p_1_
                                        solve( State_11111111( ~prog_1.3, ~prog_11111111, a, b, kEnc.2,
                                                               kSign.2
                                               ) ▶₀ #t.4 )
                                          case p_1_1111111
                                          solve( State_11111111111111( $MH.3, $SH.3, $pad.3, ~prog_1.3,
                                                                       ~prog_11111111.1, ~prog_1111111111,
                                                                       lock.1, a, b, kEnc.2, kSign.2, m.1,
                                                                       seq.3
                                                 ) ▶₀ #t.5 )
                                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                            solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j.1 )
                                              case MessageIDRule
                                              solve( State_111112111111( ~prog_1.1, ~prog_11111211.1,
                                                                         ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                         B2, kEnc, kSign, lock, pad.1, xmac,
                                                                         ~n.5, seq.1
                                                     ) ▶₀ #i2 )
                                                case eventSeqRecvabseq_0_11111211111
                                                solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1
                                                       ) ▶₀ #t.6 )
                                                  case p_1_
                                                  solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1
                                                         ) ▶₀ #t.6 )
                                                    case p_1_
                                                    solve( State_11111211( ~prog_1.3, ~prog_11111211.2, a, b,
                                                                           kEnc.1, kSign.1
                                                           ) ▶₀ #t.6 )
                                                      case p_1_1111121
                                                      by solve( State_1111121111111( ~prog_1.2,
                                                                                     ~prog_11111211.3,
                                                                                     ~prog_1111121111.3, MH.2,
                                                                                     SH.2, ~n, ~n.1, kEnc,
                                                                                     kSign, ~n.11, pad.2,
                                                                                     xmac, m, seq.2
                                                                ) ▶₀ #t2 )
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_3
                                    solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                      case p_1_
                                      solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                        case p_1_
                                        solve( State_11111111( ~prog_1.2, ~prog_11111111, a, b, kEnc.1,
                                                               kSign.1
                                               ) ▶₀ #t.4 )
                                          case p_1_1111111
                                          solve( State_11111111111111( $MH.2, $SH.2, $pad.2, ~prog_1.2,
                                                                       ~prog_11111111.1, ~prog_1111111111,
                                                                       lock.1, a, b, kEnc.1, kSign.1, m, seq.2
                                                 ) ▶₀ #t.5 )
                                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                            solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j.1 )
                                              case MessageIDRule
                                              solve( State_111112111111( ~prog_1.1, ~prog_11111211.1,
                                                                         ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                         B2, kEnc, kSign, lock, pad.1, xmac,
                                                                         ~n.5, seq.1
                                                     ) ▶₀ #i2 )
                                                case eventSeqRecvabseq_0_11111211111
                                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.6 )
                                                  case p_1_
                                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.6 )
                                                    case p_1_
                                                    solve( State_11111211( ~prog_1.2, ~prog_11111211, a, b,
                                                                           kEnc, kSign
                                                           ) ▶₀ #t.6 )
                                                      case p_1_1111121
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.6 )
                                                        case p_1_
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t.6 )
                                                          case p_1_
                                                          solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                 ) ▶₀ #t.6 )
                                                            case p_1_
                                                            solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.6 )
                                                              case p_1_
                                                              solve( State_11111111( ~prog_1.2,
                                                                                     ~prog_11111111, a, b,
                                                                                     kEnc, kSign
                                                                     ) ▶₀ #t.6 )
                                                                case p_1_1111111
                                                                solve( State_111111( ~prog_1.1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t.6 )
                                                                  case p_1_
                                                                  solve( State_111112( ~prog_1.1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.7 )
                                                                    case p_1_
                                                                    solve( State_11111211( ~prog_1.2,
                                                                                           ~prog_11111211.1,
                                                                                           a, b, kEnc, kSign
                                                                           ) ▶₀ #t.8 )
                                                                      case p_1_1111121
                                                                      solve( State_111111( ~prog_1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t.9 )
                                                                        case p_1_
                                                                        solve( State_111112( ~prog_1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t.9 )
                                                                          case p_1_
                                                                          solve( State_111111( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t.9 )
                                                                            case p_1_
                                                                            solve( State_111112( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t.9 )
                                                                              case p_1_
                                                                              solve( State_111111( ~prog_1.1,
                                                                                                   a, b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.9 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1.1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.9 )
                                                                                  case p_1_
                                                                                  solve( (∃ #t.
                                                                                           (ProgressTo_11111211111111( ~prog_1111121111.1
                                                                                            ) @ #t))  ∥
                                                                                         (∃ #t.
                                                                                           (ProgressTo_11111211112( ~prog_1111121111.1
                                                                                            ) @ #t)) )
                                                                                    case case_1
                                                                                    solve( State_1111121111111( ~prog_1.2,
                                                                                                                ~prog_11111211.2,
                                                                                                                ~prog_1111121111.1,
                                                                                                                MH.2,
                                                                                                                SH.2,
                                                                                                                a,
                                                                                                                b,
                                                                                                                kEnc,
                                                                                                                kSign,
                                                                                                                lock,
                                                                                                                pad.2,
                                                                                                                xmac,
                                                                                                                m,
                                                                                                                seq.2
                                                                                           ) ▶₀ #t.9 )
                                                                                      case eventRecvabm_0_111112111111
                                                                                      solve( State_111111( ~prog_1.1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t.10 )
                                                                                        case p_1_
                                                                                        solve( State_111112( ~prog_1.1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t.10 )
                                                                                          case p_1_
                                                                                          solve( State_11111211( ~prog_1.2,
                                                                                                                 ~prog_11111211.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                 ) ▶₀ #t.10 )
                                                                                            case p_1_1111121
                                                                                            solve( State_111111( ~prog_1.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.10 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1.1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.10 )
                                                                                                case p_1_
                                                                                                solve( !KU( senc(<
                                                                                                                  seq.1, 
                                                                                                                  ~n.5, 
                                                                                                                  pad.1, 
                                                                                                                  mac(<
                                                                                                                       MH.1, 
                                                                                                                       SH.1, 
                                                                                                                       seq.1, 
                                                                                                                       ~n.5, 
                                                                                                                       pad.1
                                                                                                                      >,
                                                                                                                      ~n.9)
                                                                                                                 >,
                                                                                                                 ~n.8)
                                                                                                       ) @ #vk.12 )
                                                                                                  case c_senc
                                                                                                  by solve( !KU( ~n.8
                                                                                                            ) @ #vk.14 )
                                                                                                next
                                                                                                  case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    by solve( State_1111121111( ~prog_1.2,
                                                                                                                ~prog_11111211.2,
                                                                                                                ~prog_1111121111.1,
                                                                                                                MH.2,
                                                                                                                SH.2,
                                                                                                                a,
                                                                                                                b,
                                                                                                                kEnc,
                                                                                                                kSign,
                                                                                                                lock,
                                                                                                                pad.2,
                                                                                                                xmac,
                                                                                                                m,
                                                                                                                seq.2
                                                                                              ) ▶₀ #t.9 )
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j )
                                case MessageIDRule
                                solve( State_111112111( ~prog_1.2, ~prog_11111211.2, a, b, ~n.2, kSign.1,
                                                        lock.1
                                       ) ▶₁ #j )
                                  case lockba_0_11111211
                                  solve( ((#vr.3 < #vr.16) ∧
                                          (∃ #t2.
                                            (Unlock_1( '1', ~n.4, <~n.1, ~n> ) @ #t2)
                                           ∧
                                            (#vr.3 < #t2) ∧
                                            (#t2 < #vr.16) ∧
                                            (∀ #t0 pp. (Unlock( pp, ~n.4, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                                            (∀ pp lpp #t0.
                                              (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.3) ∨ (#t0 = #vr.3) ∨ (#t2 < #t0))) ∧
                                            (∀ pp lpp #t0.
                                              (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.3) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                         (#vr.16 < #vr.3)  ∥ (#vr.3 = #vr.16) )
                                    case case_1
                                    solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                      case p_1_
                                      solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                        case p_1_
                                        solve( State_11111111( ~prog_1.2, ~prog_11111111, a, b, kEnc.1,
                                                               kSign.1
                                               ) ▶₀ #t.4 )
                                          case p_1_1111111
                                          solve( State_11111111111111( $MH.2, $SH.2, $pad.2, ~prog_1.2,
                                                                       ~prog_11111111.1, ~prog_1111111111,
                                                                       lock.1, a, b, kEnc.1, kSign.1, m, seq.2
                                                 ) ▶₀ #t.5 )
                                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                            solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j.1 )
                                              case MessageIDRule
                                              solve( State_111112111111( ~prog_1.1, ~prog_11111211.1,
                                                                         ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                         B2, kEnc, kSign, lock, pad.1, xmac,
                                                                         ~n.5, seq.1
                                                     ) ▶₀ #i2 )
                                                case eventSeqRecvabseq_0_11111211111
                                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.6 )
                                                  case p_1_
                                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.6 )
                                                    case p_1_
                                                    solve( State_11111211( ~prog_1.2, ~prog_11111211.2, a, b,
                                                                           kEnc, kSign
                                                           ) ▶₀ #t.6 )
                                                      case p_1_1111121
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.7 )
                                                        case p_1_
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t.7 )
                                                          case p_1_
                                                          solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                 ) ▶₀ #t.7 )
                                                            case p_1_
                                                            solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.7 )
                                                              case p_1_
                                                              solve( State_11111111( ~prog_1.2,
                                                                                     ~prog_11111111, a, b,
                                                                                     kEnc, kSign
                                                                     ) ▶₀ #t.7 )
                                                                case p_1_1111111
                                                                solve( State_111111( ~prog_1.1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t.7 )
                                                                  case p_1_
                                                                  solve( State_111112( ~prog_1.1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.8 )
                                                                    case p_1_
                                                                    solve( State_11111211( ~prog_1.2,
                                                                                           ~prog_11111211.1,
                                                                                           a, b, kEnc, kSign
                                                                           ) ▶₀ #t.9 )
                                                                      case p_1_1111121
                                                                      solve( State_111111( ~prog_1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t.10 )
                                                                        case p_1_
                                                                        solve( State_111112( ~prog_1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t.10 )
                                                                          case p_1_
                                                                          solve( State_111111( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t.10 )
                                                                            case p_1_
                                                                            solve( State_111112( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t.10 )
                                                                              case p_1_
                                                                              solve( State_111111( ~prog_1.1,
                                                                                                   a, b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.10 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1.1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.10 )
                                                                                  case p_1_
                                                                                  solve( (∃ #t.
                                                                                           (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                            ) @ #t))  ∥
                                                                                         (∃ #t.
                                                                                           (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                            ) @ #t)) )
                                                                                    case case_1
                                                                                    solve( State_1111121111111( ~prog_1.2,
                                                                                                                ~prog_11111211.3,
                                                                                                                ~prog_1111121111.2,
                                                                                                                MH.2,
                                                                                                                SH.2,
                                                                                                                a,
                                                                                                                b,
                                                                                                                kEnc,
                                                                                                                kSign,
                                                                                                                lock,
                                                                                                                pad.2,
                                                                                                                xmac,
                                                                                                                m,
                                                                                                                seq.2
                                                                                           ) ▶₀ #t.10 )
                                                                                      case eventRecvabm_0_111112111111
                                                                                      by contradiction
                                                                                         /* cyclic */
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    solve( State_1111121111( ~prog_1.2,
                                                                                                             ~prog_11111211.3,
                                                                                                             ~prog_1111121111.2,
                                                                                                             MH.2,
                                                                                                             SH.2,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign,
                                                                                                             lock,
                                                                                                             pad.2,
                                                                                                             xmac,
                                                                                                             m,
                                                                                                             seq.2
                                                                                           ) ▶₀ #t.10 )
                                                                                      case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_2
                                    solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                      case p_1_
                                      solve( State_111112( ~prog_1, a, b, kEnc.2, kSign.2 ) ▶₀ #t.4 )
                                        case p_1_
                                        solve( State_11111111( ~prog_1.3, ~prog_11111111, a, b, kEnc.2,
                                                               kSign.2
                                               ) ▶₀ #t.4 )
                                          case p_1_1111111
                                          solve( State_11111111111111( $MH.3, $SH.3, $pad.3, ~prog_1.3,
                                                                       ~prog_11111111.1, ~prog_1111111111,
                                                                       lock.1, a, b, kEnc.2, kSign.2, m.1,
                                                                       seq.3
                                                 ) ▶₀ #t.5 )
                                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                            solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j.1 )
                                              case MessageIDRule
                                              solve( State_111112111111( ~prog_1.1, ~prog_11111211.1,
                                                                         ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                         B2, kEnc, kSign, lock, pad.1, xmac,
                                                                         ~n.5, seq.1
                                                     ) ▶₀ #i2 )
                                                case eventSeqRecvabseq_0_11111211111
                                                solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1
                                                       ) ▶₀ #t.6 )
                                                  case p_1_
                                                  solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1
                                                         ) ▶₀ #t.6 )
                                                    case p_1_
                                                    solve( State_11111211( ~prog_1.3, ~prog_11111211.2, a, b,
                                                                           kEnc.1, kSign.1
                                                           ) ▶₀ #t.6 )
                                                      case p_1_1111121
                                                      by solve( State_1111121111111( ~prog_1.2,
                                                                                     ~prog_11111211.3,
                                                                                     ~prog_1111121111.3, MH.2,
                                                                                     SH.2, ~n, ~n.1, kEnc,
                                                                                     kSign, ~n.11, pad.2,
                                                                                     xmac, m, seq.2
                                                                ) ▶₀ #t2 )
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_3
                                    solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                      case p_1_
                                      solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                                        case p_1_
                                        solve( State_11111111( ~prog_1.2, ~prog_11111111, a, b, kEnc.1,
                                                               kSign.1
                                               ) ▶₀ #t.4 )
                                          case p_1_1111111
                                          solve( State_11111111111111( $MH.2, $SH.2, $pad.2, ~prog_1.2,
                                                                       ~prog_11111111.1, ~prog_1111111111,
                                                                       lock.1, a, b, kEnc.1, kSign.1, m, seq.2
                                                 ) ▶₀ #t.5 )
                                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                            solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j.1 )
                                              case MessageIDRule
                                              solve( State_111112111111( ~prog_1.1, ~prog_11111211.1,
                                                                         ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                         B2, kEnc, kSign, lock, pad.1, xmac,
                                                                         ~n.5, seq.1
                                                     ) ▶₀ #i2 )
                                                case eventSeqRecvabseq_0_11111211111
                                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.6 )
                                                  case p_1_
                                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.6 )
                                                    case p_1_
                                                    solve( State_11111211( ~prog_1.2, ~prog_11111211, a, b,
                                                                           kEnc, kSign
                                                           ) ▶₀ #t.6 )
                                                      case p_1_1111121
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.6 )
                                                        case p_1_
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t.6 )
                                                          case p_1_
                                                          solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                 ) ▶₀ #t.6 )
                                                            case p_1_
                                                            solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.6 )
                                                              case p_1_
                                                              solve( State_11111111( ~prog_1.2,
                                                                                     ~prog_11111111, a, b,
                                                                                     kEnc, kSign
                                                                     ) ▶₀ #t.6 )
                                                                case p_1_1111111
                                                                solve( State_111111( ~prog_1.1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t.6 )
                                                                  case p_1_
                                                                  solve( State_111112( ~prog_1.1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.7 )
                                                                    case p_1_
                                                                    solve( State_11111211( ~prog_1.2,
                                                                                           ~prog_11111211.1,
                                                                                           a, b, kEnc, kSign
                                                                           ) ▶₀ #t.8 )
                                                                      case p_1_1111121
                                                                      solve( State_111111( ~prog_1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t.9 )
                                                                        case p_1_
                                                                        solve( State_111112( ~prog_1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t.9 )
                                                                          case p_1_
                                                                          solve( State_111111( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t.9 )
                                                                            case p_1_
                                                                            solve( State_111112( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t.9 )
                                                                              case p_1_
                                                                              solve( State_111111( ~prog_1.1,
                                                                                                   a, b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.9 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1.1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.9 )
                                                                                  case p_1_
                                                                                  solve( (∃ #t.
                                                                                           (ProgressTo_11111211111111( ~prog_1111121111.1
                                                                                            ) @ #t))  ∥
                                                                                         (∃ #t.
                                                                                           (ProgressTo_11111211112( ~prog_1111121111.1
                                                                                            ) @ #t)) )
                                                                                    case case_1
                                                                                    solve( State_1111121111111( ~prog_1.2,
                                                                                                                ~prog_11111211.2,
                                                                                                                ~prog_1111121111.1,
                                                                                                                MH.2,
                                                                                                                SH.2,
                                                                                                                a,
                                                                                                                b,
                                                                                                                kEnc,
                                                                                                                kSign,
                                                                                                                lock,
                                                                                                                pad.2,
                                                                                                                xmac,
                                                                                                                m,
                                                                                                                seq.2
                                                                                           ) ▶₀ #t.9 )
                                                                                      case eventRecvabm_0_111112111111
                                                                                      solve( State_111111( ~prog_1.1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t.10 )
                                                                                        case p_1_
                                                                                        solve( State_111112( ~prog_1.1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t.10 )
                                                                                          case p_1_
                                                                                          solve( State_11111211( ~prog_1.2,
                                                                                                                 ~prog_11111211.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                 ) ▶₀ #t.10 )
                                                                                            case p_1_1111121
                                                                                            solve( State_111111( ~prog_1.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.10 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1.1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.10 )
                                                                                                case p_1_
                                                                                                solve( !KU( senc(<
                                                                                                                  seq.1, 
                                                                                                                  ~n.5, 
                                                                                                                  pad.1, 
                                                                                                                  mac(<
                                                                                                                       MH.1, 
                                                                                                                       SH.1, 
                                                                                                                       seq.1, 
                                                                                                                       ~n.5, 
                                                                                                                       pad.1
                                                                                                                      >,
                                                                                                                      ~n.9)
                                                                                                                 >,
                                                                                                                 ~n.8)
                                                                                                       ) @ #vk.12 )
                                                                                                  case c_senc
                                                                                                  by solve( !KU( ~n.8
                                                                                                            ) @ #vk.14 )
                                                                                                next
                                                                                                  case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                                  by contradiction
                                                                                                     /* cyclic
                                                                                                     */
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  next
                                                                                    case case_2
                                                                                    by solve( State_1111121111( ~prog_1.2,
                                                                                                                ~prog_11111211.2,
                                                                                                                ~prog_1111121111.1,
                                                                                                                MH.2,
                                                                                                                SH.2,
                                                                                                                a,
                                                                                                                b,
                                                                                                                kEnc,
                                                                                                                kSign,
                                                                                                                lock,
                                                                                                                pad.2,
                                                                                                                xmac,
                                                                                                                m,
                                                                                                                seq.2
                                                                                              ) ▶₀ #t.9 )
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case case_2
              by solve( State_1111121111( ~prog_1.1, ~prog_11111211.1,
                                          ~prog_1111121111, MH.1, SH.1, a, b, kEnc, kSign, lock, pad.1, xmac,
                                          m, seq.1
                        ) ▶₀ #t.4 )
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma order:
  all-traces
  "∀ A B m m2 #i #j.
    (((Recv( A, B, m ) @ #i) ∧ (Recv( A, B, m2 ) @ #j)) ∧ (#i < #j)) ⇒
    (∃ #k #l.
      ((Sent( A, B, m ) @ #k) ∧ (Sent( A, B, m2 ) @ #l)) ∧ (#k < #l))"
/*
guarded formula characterizing all counter-examples:
"∃ A B m m2 #i #j.
  (Recv( A, B, m ) @ #i) ∧ (Recv( A, B, m2 ) @ #j)
 ∧
  (#i < #j) ∧
  (∀ #k #l. (Sent( A, B, m ) @ #k) ∧ (Sent( A, B, m2 ) @ #l) ⇒ ¬(#k < #l))"
*/
simplify
solve( State_111112111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH,
                           SH, A, B, kEnc, kSign, lock, pad, xmac, m, seq
       ) ▶₀ #i )
  case eventSeqRecvabseq_0_11111211111
  solve( State_111112111111( ~prog_1.1, ~prog_11111211.1,
                             ~prog_1111121111.1, MH.1, SH.1, ~n, ~n.1, kEnc, kSign, lock, pad.1, xmac,
                             m2, seq.1
         ) ▶₀ #j )
    case eventSeqRecvabseq_0_11111211111
    solve( (¬(#vr < #vr.8))  ∥ (∃ dif. (seq.1 = (dif++seq))) )
      case case_1
      solve( (¬(#vr.8 < #vr))  ∥ (∃ dif. (seq = (dif++seq.1))) )
        case case_1
        solve( ((#vr.3 < #vr.11) ∧
                (∃ #t2.
                  (Unlock_1( '1', ~n.4, <~n.1, ~n> ) @ #t2)
                 ∧
                  (#vr.3 < #t2) ∧
                  (#t2 < #vr.11) ∧
                  (∀ #t0 pp. (Unlock( pp, ~n.4, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                  (∀ pp lpp #t0.
                    (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.3) ∨ (#t0 = #vr.3) ∨ (#t2 < #t0))) ∧
                  (∀ pp lpp #t0.
                    (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.3) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
               (#vr.11 < #vr.3)  ∥ (#vr.3 = #vr.11) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* cyclic */
        next
          case case_3
          by contradiction /* cyclic */
        qed
      next
        case case_2
        solve( ((#vr.3 < #vr.11) ∧
                (∃ #t2.
                  (Unlock_1( '1', ~n.4, <~n.1, ~n> ) @ #t2)
                 ∧
                  (#vr.3 < #t2) ∧
                  (#t2 < #vr.11) ∧
                  (∀ #t0 pp. (Unlock( pp, ~n.4, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                  (∀ pp lpp #t0.
                    (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.3) ∨ (#t0 = #vr.3) ∨ (#t2 < #t0))) ∧
                  (∀ pp lpp #t0.
                    (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.3) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
               (#vr.11 < #vr.3)  ∥ (#vr.3 = #vr.11) )
          case case_1
          by contradiction /* cyclic */
        next
          case case_2
          by contradiction /* cyclic */
        qed
      qed
    next
      case case_2
      solve( (¬(#vr.8 < #vr))  ∥ (∃ dif.1. (seq = (dif++seq++dif.1))) )
        case case_1
        solve( ((#vr.3 < #vr.11) ∧
                (∃ #t2.
                  (Unlock_1( '1', ~n.4, <~n.1, ~n> ) @ #t2)
                 ∧
                  (#vr.3 < #t2) ∧
                  (#t2 < #vr.11) ∧
                  (∀ #t0 pp. (Unlock( pp, ~n.4, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                  (∀ pp lpp #t0.
                    (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.3) ∨ (#t0 = #vr.3) ∨ (#t2 < #t0))) ∧
                  (∀ pp lpp #t0.
                    (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.3) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
               (#vr.11 < #vr.3)  ∥ (#vr.3 = #vr.11) )
          case case_1
          solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.1 )
            case p_1_
            solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.2 )
              case p_1_
              solve( State_11111211( ~prog_1.2, ~prog_11111211, a, b, kEnc.1, kSign.1
                     ) ▶₀ #t.3 )
                case p_1_1111121
                solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                  case p_1_
                  solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.4 )
                    case p_1_
                    solve( State_11111211( ~prog_1.2, ~prog_11111211.1, a, b, kEnc.1, kSign.1
                           ) ▶₀ #t.4 )
                      case p_1_1111121
                      solve( State_1111121111111( ~prog_1.1, ~prog_11111211.2,
                                                  ~prog_1111121111.2, MH.2, SH.2, ~n, ~n.1, kEnc, kSign, ~n.4,
                                                  pad.2, xmac, m.1, seq.1
                             ) ▶₀ #t2 )
                        case eventRecvabm_0_111112111111_case_1
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                          case p_1_
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                            case p_1_
                            solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                              case p_1_
                              solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                case p_1_
                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                  case p_1_
                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                    case p_1_
                                    solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
                                           ) ▶₀ #t.5 )
                                      case p_1_1111121
                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                        case p_1_
                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                          case p_1_
                                          solve( (∃ #t.
                                                   (ProgressTo_11111211111111( ~prog_1111121111 ) @ #t))  ∥
                                                 (∃ #t. (ProgressTo_11111211112( ~prog_1111121111 ) @ #t)) )
                                            case case_1
                                            solve( State_1111121111111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq
                                                   ) ▶₀ #t.5 )
                                              case eventRecvabm_0_111112111111
                                              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                case p_1_
                                                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                  case p_1_
                                                  solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b,
                                                                         kEnc, kSign
                                                         ) ▶₀ #t.5 )
                                                    case p_1_1111121
                                                    solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                           ) ▶₀ #t.5 )
                                                      case p_1_
                                                      solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.5 )
                                                        case p_1_
                                                        solve( (∃ #t.
                                                                 (ProgressTo_11111211111111( ~prog_1111121111.1
                                                                  ) @ #t))  ∥
                                                               (∃ #t.
                                                                 (ProgressTo_11111211112( ~prog_1111121111.1
                                                                  ) @ #t)) )
                                                          case case_1
                                                          solve( State_1111121111111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq
                                                                 ) ▶₀ #t.5 )
                                                            case eventRecvabm_0_111112111111
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.6 )
                                                              case p_1_
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t.6 )
                                                                case p_1_
                                                                solve( State_11111211( ~prog_1.1,
                                                                                       ~prog_11111211.1, a, b,
                                                                                       kEnc, kSign
                                                                       ) ▶₀ #t.6 )
                                                                  case p_1_1111121
                                                                  solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.6 )
                                                                    case p_1_
                                                                    solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                         kSign
                                                                           ) ▶₀ #t.6 )
                                                                      case p_1_
                                                                      solve( !KU( senc(<dif, m, pad, 
                                                                                        mac(<MH, SH, dif, m, 
                                                                                             pad>,
                                                                                            ~n.3)
                                                                                       >,
                                                                                       ~n.2)
                                                                             ) @ #vk.4 )
                                                                        case c_senc
                                                                        solve( !KU( senc(<(dif++dif), m2, 
                                                                                          pad.1, 
                                                                                          mac(<MH.1, SH.1, 
                                                                                               (dif++dif), 
                                                                                               m2, pad.1>,
                                                                                              ~n.3)
                                                                                         >,
                                                                                         ~n.2)
                                                                               ) @ #vk.9 )
                                                                          case c_senc
                                                                          by solve( !KU( ~n.2 ) @ #vk.11 )
                                                                        next
                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                 ) ▶₃ #j.1 )
                                                                            case MessageIDRule
                                                                            solve( State_111112111( ~prog_1.1,
                                                                                                    ~prog_11111211.2,
                                                                                                    a, b,
                                                                                                    ~n.2,
                                                                                                    kSign,
                                                                                                    lock
                                                                                   ) ▶₁ #j.1 )
                                                                              case lockba_0_11111211
                                                                              solve( ((#t.3 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.3 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t0 = #t.3) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.3)  ∥
                                                                                     (#t.3 = #vr.20) )
                                                                                case case_1
                                                                                solve( ((#t.4 < #vr.20) ∧
                                                                                        (∃ #t2.
                                                                                          (Unlock_1( '1',
                                                                                                     ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                           ) @ #t2)
                                                                                         ∧
                                                                                          (#t.4 < #t2) ∧
                                                                                          (#t2 < #vr.20) ∧
                                                                                          (∀ #t0 pp.
                                                                                            (Unlock( pp, ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            #t0 = #t2) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Lock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t0 = #t.4) ∨
                                                                                             (#t2 < #t0))) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Unlock( pp, lpp,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t2 < #t0) ∨
                                                                                             (#t2 =
                                                                                              #t0)))))  ∥
                                                                                       (#vr.20 < #t.4)  ∥
                                                                                       (#t.4 = #vr.20) )
                                                                                  case case_1
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.9 )
                                                                                                                    case p_1_
                                                                                                                    solve( (∃ #t.
                                                                                                                             (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                              ) @ #t))  ∥
                                                                                                                           (∃ #t.
                                                                                                                             (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                              ) @ #t)) )
                                                                                                                      case case_1
                                                                                                                      solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                  ~prog_11111211.3,
                                                                                                                                                  ~prog_1111121111.2,
                                                                                                                                                  MH.2,
                                                                                                                                                  SH.2,
                                                                                                                                                  a,
                                                                                                                                                  b,
                                                                                                                                                  kEnc,
                                                                                                                                                  kSign,
                                                                                                                                                  lock,
                                                                                                                                                  pad.2,
                                                                                                                                                  xmac,
                                                                                                                                                  m.1,
                                                                                                                                                  seq
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case eventRecvabm_0_111112111111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    next
                                                                                                                      case case_2
                                                                                                                      solve( State_1111121111( ~prog_1.1,
                                                                                                                                               ~prog_11111211.3,
                                                                                                                                               ~prog_1111121111.2,
                                                                                                                                               MH.2,
                                                                                                                                               SH.2,
                                                                                                                                               a,
                                                                                                                                               b,
                                                                                                                                               kEnc,
                                                                                                                                               kSign,
                                                                                                                                               lock,
                                                                                                                                               pad.2,
                                                                                                                                               xmac,
                                                                                                                                               m.1,
                                                                                                                                               seq
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           from formulas
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.2,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.3,
                                                                                                                     $SH.3,
                                                                                                                     $pad.3,
                                                                                                                     ~prog_1.2,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1,
                                                                                                                     m.2,
                                                                                                                     seq.1
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.2,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc.1,
                                                                                                                       kSign.1
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  by solve( State_1111121111111( ~prog_1.1,
                                                                                                                                 ~prog_11111211.3,
                                                                                                                                 ~prog_1111121111.3,
                                                                                                                                 MH.2,
                                                                                                                                 SH.2,
                                                                                                                                 ~n,
                                                                                                                                 ~n.1,
                                                                                                                                 kEnc,
                                                                                                                                 kSign,
                                                                                                                                 ~n.7,
                                                                                                                                 pad.2,
                                                                                                                                 xmac,
                                                                                                                                 m.1,
                                                                                                                                 seq
                                                                                                            ) ▶₀ #t2.1 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_3
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.8 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.8 )
                                                                                                                    case p_1_
                                                                                                                    by solve( !KU( ~n.2
                                                                                                                              ) @ #vk.11 )
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.2,
                                                                                                                   seq.1
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m.1,
                                                                                                                               seq
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      next
                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                               ) ▶₃ #j.1 )
                                                                          case MessageIDRule
                                                                          solve( State_111112111( ~prog_1.1,
                                                                                                  ~prog_11111211.2,
                                                                                                  a, b, ~n.2,
                                                                                                  kSign, lock
                                                                                 ) ▶₁ #j.1 )
                                                                            case lockba_0_11111211
                                                                            solve( ((#t.3 < #vr.20) ∧
                                                                                    (∃ #t2.
                                                                                      (Unlock_1( '1', ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                       ) @ #t2)
                                                                                     ∧
                                                                                      (#t.3 < #t2) ∧
                                                                                      (#t2 < #vr.20) ∧
                                                                                      (∀ #t0 pp.
                                                                                        (Unlock( pp, ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        #t0 = #t2) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Lock( pp, lpp,
                                                                                               <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t0 = #t.3) ∨
                                                                                         (#t2 < #t0))) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Unlock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t2 < #t0) ∨
                                                                                         (#t2 = #t0)))))  ∥
                                                                                   (#vr.20 < #t.3)  ∥
                                                                                   (#t.3 = #vr.20) )
                                                                              case case_1
                                                                              solve( ((#t.4 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.4 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t0 = #t.4) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.4)  ∥
                                                                                     (#t.4 = #vr.20) )
                                                                                case case_1
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.1,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.2,
                                                                                                                   $SH.2,
                                                                                                                   $pad.2,
                                                                                                                   ~prog_1.1,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign,
                                                                                                                   m,
                                                                                                                   seq
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.1,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                solve( State_111111( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.9 )
                                                                                                  case p_1_
                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111111( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111112( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_11111111( ~prog_1.1,
                                                                                                                               ~prog_11111111,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_1111111
                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_
                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111111( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111112( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( (∃ #t.
                                                                                                                           (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                            ) @ #t))  ∥
                                                                                                                         (∃ #t.
                                                                                                                           (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                            ) @ #t)) )
                                                                                                                    case case_1
                                                                                                                    solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                ~prog_11111211.3,
                                                                                                                                                ~prog_1111121111.2,
                                                                                                                                                MH.2,
                                                                                                                                                SH.2,
                                                                                                                                                a,
                                                                                                                                                b,
                                                                                                                                                kEnc,
                                                                                                                                                kSign,
                                                                                                                                                lock,
                                                                                                                                                pad.2,
                                                                                                                                                xmac,
                                                                                                                                                m,
                                                                                                                                                seq
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case eventRecvabm_0_111112111111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         cyclic
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  next
                                                                                                                    case case_2
                                                                                                                    solve( State_1111121111( ~prog_1.1,
                                                                                                                                             ~prog_11111211.3,
                                                                                                                                             ~prog_1111121111.2,
                                                                                                                                             MH.2,
                                                                                                                                             SH.2,
                                                                                                                                             a,
                                                                                                                                             b,
                                                                                                                                             kEnc,
                                                                                                                                             kSign,
                                                                                                                                             lock,
                                                                                                                                             pad.2,
                                                                                                                                             xmac,
                                                                                                                                             m,
                                                                                                                                             seq
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         from formulas
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.1,
                                                                                                                   seq.1
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m,
                                                                                                                               seq
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc.1,
                                                                                                     kSign.1
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.2,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.3,
                                                                                                                 $SH.3,
                                                                                                                 $pad.3,
                                                                                                                 ~prog_1.2,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1,
                                                                                                                 m.1,
                                                                                                                 seq.1
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.2,
                                                                                                                   ~prog_11111211.2,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              by solve( State_1111121111111( ~prog_1.1,
                                                                                                                             ~prog_11111211.3,
                                                                                                                             ~prog_1111121111.3,
                                                                                                                             MH.2,
                                                                                                                             SH.2,
                                                                                                                             ~n,
                                                                                                                             ~n.1,
                                                                                                                             kEnc,
                                                                                                                             kSign,
                                                                                                                             ~n.7,
                                                                                                                             pad.2,
                                                                                                                             xmac,
                                                                                                                             m,
                                                                                                                             seq
                                                                                                        ) ▶₀ #t2.1 )
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_3
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.1,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.2,
                                                                                                                 $SH.2,
                                                                                                                 $pad.2,
                                                                                                                 ~prog_1.1,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign,
                                                                                                                 m,
                                                                                                                 seq
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.1,
                                                                                                                   ~prog_11111211,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              solve( State_111111( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_111112( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                                             ~prog_11111111,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_1111111
                                                                                                        solve( State_111111( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_111112( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( !KU( senc(<
                                                                                                                                  (
                                                                                                                                   dif++
                                                                                                                                   dif
                                                                                                                                  ), 
                                                                                                                                  m2, 
                                                                                                                                  pad.1, 
                                                                                                                                  mac(<
                                                                                                                                       MH.1, 
                                                                                                                                       SH.1, 
                                                                                                                                       (
                                                                                                                                        dif++
                                                                                                                                        dif
                                                                                                                                       ), 
                                                                                                                                       m2, 
                                                                                                                                       pad.1
                                                                                                                                      >,
                                                                                                                                      ~n.3)
                                                                                                                                 >,
                                                                                                                                 ~n.2)
                                                                                                                       ) @ #vk.9 )
                                                                                                                  case c_senc
                                                                                                                  by solve( !KU( ~n.2
                                                                                                                            ) @ #vk.15 )
                                                                                                                next
                                                                                                                  case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                                                  solve( (¬(#vr.14 < #vr.22))  ∥
                                                                                                                         (∃ dif.1.
                                                                                                                           ((
                                                                                                                             dif++
                                                                                                                             dif
                                                                                                                            ) =
                                                                                                                            (
                                                                                                                             dif++
                                                                                                                             dif.1
                                                                                                                            ))) )
                                                                                                                    case case_2
                                                                                                                    solve( (¬(#vr.22 < #vr.14))  ∥
                                                                                                                           (∃ dif.1.
                                                                                                                             (dif =
                                                                                                                              (
                                                                                                                               dif++
                                                                                                                               dif++
                                                                                                                               dif.1
                                                                                                                              ))) )
                                                                                                                      case case_1
                                                                                                                      solve( ((#t.6 < #vr.24) ∧
                                                                                                                              (∃ #t2.
                                                                                                                                (Unlock_0( '0',
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                 ) @ #t2)
                                                                                                                               ∧
                                                                                                                                (#t.6 < #t2) ∧
                                                                                                                                (#t2 < #vr.24) ∧
                                                                                                                                (∀ #t0
                                                                                                                                   pp.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  #t0 =
                                                                                                                                  #t2) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Lock( pp,
                                                                                                                                         lpp,
                                                                                                                                         <
                                                                                                                                          ~n, 
                                                                                                                                          ~n.1
                                                                                                                                         >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t0 =
                                                                                                                                    #t.6) ∨
                                                                                                                                   (#t2 < #t0))) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           lpp,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t2 < #t0) ∨
                                                                                                                                   (#t2 =
                                                                                                                                    #t0)))))  ∥
                                                                                                                             (#vr.24 < #t.6)  ∥
                                                                                                                             (#t.6 =
                                                                                                                              #vr.24) )
                                                                                                                        case case_1
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      next
                                                                                                                        case case_2
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by solve( State_1111121111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq
                                                                    ) ▶₀ #t.5 )
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            by solve( State_1111121111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq
                                                      ) ▶₀ #t.5 )
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case eventRecvabm_0_111112111111_case_2
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                          case p_1_
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                            case p_1_
                            solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                              case p_1_
                              solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                case p_1_
                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                  case p_1_
                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                    case p_1_
                                    solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
                                           ) ▶₀ #t.5 )
                                      case p_1_1111121
                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                        case p_1_
                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                          case p_1_
                                          solve( (∃ #t.
                                                   (ProgressTo_11111211111111( ~prog_1111121111 ) @ #t))  ∥
                                                 (∃ #t. (ProgressTo_11111211112( ~prog_1111121111 ) @ #t)) )
                                            case case_1
                                            solve( State_1111121111111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq.1
                                                   ) ▶₀ #t.5 )
                                              case eventRecvabm_0_111112111111
                                              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                case p_1_
                                                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                  case p_1_
                                                  solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b,
                                                                         kEnc, kSign
                                                         ) ▶₀ #t.5 )
                                                    case p_1_1111121
                                                    solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                           ) ▶₀ #t.5 )
                                                      case p_1_
                                                      solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.5 )
                                                        case p_1_
                                                        solve( (∃ #t.
                                                                 (ProgressTo_11111211111111( ~prog_1111121111.1
                                                                  ) @ #t))  ∥
                                                               (∃ #t.
                                                                 (ProgressTo_11111211112( ~prog_1111121111.1
                                                                  ) @ #t)) )
                                                          case case_1
                                                          solve( State_1111121111111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq.1
                                                                 ) ▶₀ #t.5 )
                                                            case eventRecvabm_0_111112111111
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.6 )
                                                              case p_1_
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t.6 )
                                                                case p_1_
                                                                solve( State_11111211( ~prog_1.1,
                                                                                       ~prog_11111211.1, a, b,
                                                                                       kEnc, kSign
                                                                       ) ▶₀ #t.6 )
                                                                  case p_1_1111121
                                                                  solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.6 )
                                                                    case p_1_
                                                                    solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                         kSign
                                                                           ) ▶₀ #t.6 )
                                                                      case p_1_
                                                                      solve( !KU( senc(<seq, m, pad, 
                                                                                        mac(<MH, SH, seq, m, 
                                                                                             pad>,
                                                                                            ~n.3)
                                                                                       >,
                                                                                       ~n.2)
                                                                             ) @ #vk.4 )
                                                                        case c_senc
                                                                        solve( !KU( senc(<(dif++seq), m2, 
                                                                                          pad.1, 
                                                                                          mac(<MH.1, SH.1, 
                                                                                               (dif++seq), 
                                                                                               m2, pad.1>,
                                                                                              ~n.3)
                                                                                         >,
                                                                                         ~n.2)
                                                                               ) @ #vk.9 )
                                                                          case c_senc
                                                                          by solve( !KU( ~n.2 ) @ #vk.11 )
                                                                        next
                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                 ) ▶₃ #j.1 )
                                                                            case MessageIDRule
                                                                            solve( State_111112111( ~prog_1.1,
                                                                                                    ~prog_11111211.2,
                                                                                                    a, b,
                                                                                                    ~n.2,
                                                                                                    kSign,
                                                                                                    lock
                                                                                   ) ▶₁ #j.1 )
                                                                              case lockba_0_11111211
                                                                              solve( ((#t.3 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.3 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t0 = #t.3) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.3)  ∥
                                                                                     (#t.3 = #vr.20) )
                                                                                case case_1
                                                                                solve( ((#t.4 < #vr.20) ∧
                                                                                        (∃ #t2.
                                                                                          (Unlock_1( '1',
                                                                                                     ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                           ) @ #t2)
                                                                                         ∧
                                                                                          (#t.4 < #t2) ∧
                                                                                          (#t2 < #vr.20) ∧
                                                                                          (∀ #t0 pp.
                                                                                            (Unlock( pp, ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            #t0 = #t2) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Lock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t0 = #t.4) ∨
                                                                                             (#t2 < #t0))) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Unlock( pp, lpp,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t2 < #t0) ∨
                                                                                             (#t2 =
                                                                                              #t0)))))  ∥
                                                                                       (#vr.20 < #t.4)  ∥
                                                                                       (#t.4 = #vr.20) )
                                                                                  case case_1
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq.1
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.9 )
                                                                                                                    case p_1_
                                                                                                                    solve( (∃ #t.
                                                                                                                             (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                              ) @ #t))  ∥
                                                                                                                           (∃ #t.
                                                                                                                             (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                              ) @ #t)) )
                                                                                                                      case case_1
                                                                                                                      solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                  ~prog_11111211.3,
                                                                                                                                                  ~prog_1111121111.2,
                                                                                                                                                  MH.2,
                                                                                                                                                  SH.2,
                                                                                                                                                  a,
                                                                                                                                                  b,
                                                                                                                                                  kEnc,
                                                                                                                                                  kSign,
                                                                                                                                                  lock,
                                                                                                                                                  pad.2,
                                                                                                                                                  xmac,
                                                                                                                                                  m.1,
                                                                                                                                                  seq.1
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case eventRecvabm_0_111112111111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    next
                                                                                                                      case case_2
                                                                                                                      solve( State_1111121111( ~prog_1.1,
                                                                                                                                               ~prog_11111211.3,
                                                                                                                                               ~prog_1111121111.2,
                                                                                                                                               MH.2,
                                                                                                                                               SH.2,
                                                                                                                                               a,
                                                                                                                                               b,
                                                                                                                                               kEnc,
                                                                                                                                               kSign,
                                                                                                                                               lock,
                                                                                                                                               pad.2,
                                                                                                                                               xmac,
                                                                                                                                               m.1,
                                                                                                                                               seq.1
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           from formulas
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.2,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.3,
                                                                                                                     $SH.3,
                                                                                                                     $pad.3,
                                                                                                                     ~prog_1.2,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1,
                                                                                                                     m.2,
                                                                                                                     seq.2
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.2,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc.1,
                                                                                                                       kSign.1
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  by solve( State_1111121111111( ~prog_1.1,
                                                                                                                                 ~prog_11111211.3,
                                                                                                                                 ~prog_1111121111.3,
                                                                                                                                 MH.2,
                                                                                                                                 SH.2,
                                                                                                                                 ~n,
                                                                                                                                 ~n.1,
                                                                                                                                 kEnc,
                                                                                                                                 kSign,
                                                                                                                                 ~n.7,
                                                                                                                                 pad.2,
                                                                                                                                 xmac,
                                                                                                                                 m.1,
                                                                                                                                 seq.1
                                                                                                            ) ▶₀ #t2.1 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_3
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq.1
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.8 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.8 )
                                                                                                                    case p_1_
                                                                                                                    by solve( !KU( ~n.2
                                                                                                                              ) @ #vk.11 )
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.2,
                                                                                                                   seq.2
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m.1,
                                                                                                                               seq.1
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      next
                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                               ) ▶₃ #j.1 )
                                                                          case MessageIDRule
                                                                          solve( State_111112111( ~prog_1.1,
                                                                                                  ~prog_11111211.2,
                                                                                                  a, b, ~n.2,
                                                                                                  kSign, lock
                                                                                 ) ▶₁ #j.1 )
                                                                            case lockba_0_11111211
                                                                            solve( ((#t.3 < #vr.20) ∧
                                                                                    (∃ #t2.
                                                                                      (Unlock_1( '1', ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                       ) @ #t2)
                                                                                     ∧
                                                                                      (#t.3 < #t2) ∧
                                                                                      (#t2 < #vr.20) ∧
                                                                                      (∀ #t0 pp.
                                                                                        (Unlock( pp, ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        #t0 = #t2) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Lock( pp, lpp,
                                                                                               <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t0 = #t.3) ∨
                                                                                         (#t2 < #t0))) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Unlock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t2 < #t0) ∨
                                                                                         (#t2 = #t0)))))  ∥
                                                                                   (#vr.20 < #t.3)  ∥
                                                                                   (#t.3 = #vr.20) )
                                                                              case case_1
                                                                              solve( ((#t.4 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.4 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t0 = #t.4) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.4)  ∥
                                                                                     (#t.4 = #vr.20) )
                                                                                case case_1
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.1,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.2,
                                                                                                                   $SH.2,
                                                                                                                   $pad.2,
                                                                                                                   ~prog_1.1,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign,
                                                                                                                   m,
                                                                                                                   seq.1
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.1,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                solve( State_111111( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.9 )
                                                                                                  case p_1_
                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111111( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111112( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_11111111( ~prog_1.1,
                                                                                                                               ~prog_11111111,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_1111111
                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_
                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111111( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111112( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( (∃ #t.
                                                                                                                           (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                            ) @ #t))  ∥
                                                                                                                         (∃ #t.
                                                                                                                           (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                            ) @ #t)) )
                                                                                                                    case case_1
                                                                                                                    solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                ~prog_11111211.3,
                                                                                                                                                ~prog_1111121111.2,
                                                                                                                                                MH.2,
                                                                                                                                                SH.2,
                                                                                                                                                a,
                                                                                                                                                b,
                                                                                                                                                kEnc,
                                                                                                                                                kSign,
                                                                                                                                                lock,
                                                                                                                                                pad.2,
                                                                                                                                                xmac,
                                                                                                                                                m,
                                                                                                                                                seq.1
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case eventRecvabm_0_111112111111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         cyclic
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  next
                                                                                                                    case case_2
                                                                                                                    solve( State_1111121111( ~prog_1.1,
                                                                                                                                             ~prog_11111211.3,
                                                                                                                                             ~prog_1111121111.2,
                                                                                                                                             MH.2,
                                                                                                                                             SH.2,
                                                                                                                                             a,
                                                                                                                                             b,
                                                                                                                                             kEnc,
                                                                                                                                             kSign,
                                                                                                                                             lock,
                                                                                                                                             pad.2,
                                                                                                                                             xmac,
                                                                                                                                             m,
                                                                                                                                             seq.1
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         from formulas
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.1,
                                                                                                                   seq.2
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m,
                                                                                                                               seq.1
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc.1,
                                                                                                     kSign.1
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.2,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.3,
                                                                                                                 $SH.3,
                                                                                                                 $pad.3,
                                                                                                                 ~prog_1.2,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1,
                                                                                                                 m.1,
                                                                                                                 seq.2
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.2,
                                                                                                                   ~prog_11111211.2,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              by solve( State_1111121111111( ~prog_1.1,
                                                                                                                             ~prog_11111211.3,
                                                                                                                             ~prog_1111121111.3,
                                                                                                                             MH.2,
                                                                                                                             SH.2,
                                                                                                                             ~n,
                                                                                                                             ~n.1,
                                                                                                                             kEnc,
                                                                                                                             kSign,
                                                                                                                             ~n.7,
                                                                                                                             pad.2,
                                                                                                                             xmac,
                                                                                                                             m,
                                                                                                                             seq.1
                                                                                                        ) ▶₀ #t2.1 )
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_3
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.1,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.2,
                                                                                                                 $SH.2,
                                                                                                                 $pad.2,
                                                                                                                 ~prog_1.1,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign,
                                                                                                                 m,
                                                                                                                 seq.1
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.1,
                                                                                                                   ~prog_11111211,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              solve( State_111111( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_111112( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                                             ~prog_11111111,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_1111111
                                                                                                        solve( State_111111( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_111112( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( !KU( senc(<
                                                                                                                                  (
                                                                                                                                   dif++
                                                                                                                                   seq
                                                                                                                                  ), 
                                                                                                                                  m2, 
                                                                                                                                  pad.1, 
                                                                                                                                  mac(<
                                                                                                                                       MH.1, 
                                                                                                                                       SH.1, 
                                                                                                                                       (
                                                                                                                                        dif++
                                                                                                                                        seq
                                                                                                                                       ), 
                                                                                                                                       m2, 
                                                                                                                                       pad.1
                                                                                                                                      >,
                                                                                                                                      ~n.3)
                                                                                                                                 >,
                                                                                                                                 ~n.2)
                                                                                                                       ) @ #vk.9 )
                                                                                                                  case c_senc
                                                                                                                  by solve( !KU( ~n.2
                                                                                                                            ) @ #vk.15 )
                                                                                                                next
                                                                                                                  case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                                                  solve( (¬(#vr.14 < #vr.22))  ∥
                                                                                                                         (∃ dif.1.
                                                                                                                           ((
                                                                                                                             dif++
                                                                                                                             seq
                                                                                                                            ) =
                                                                                                                            (
                                                                                                                             seq++
                                                                                                                             dif.1
                                                                                                                            ))) )
                                                                                                                    case case_2
                                                                                                                    solve( (¬(#vr.22 < #vr.14))  ∥
                                                                                                                           (∃ dif.1.
                                                                                                                             (seq =
                                                                                                                              (
                                                                                                                               dif++
                                                                                                                               seq++
                                                                                                                               dif.1
                                                                                                                              ))) )
                                                                                                                      case case_1
                                                                                                                      solve( ((#t.6 < #vr.24) ∧
                                                                                                                              (∃ #t2.
                                                                                                                                (Unlock_0( '0',
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                 ) @ #t2)
                                                                                                                               ∧
                                                                                                                                (#t.6 < #t2) ∧
                                                                                                                                (#t2 < #vr.24) ∧
                                                                                                                                (∀ #t0
                                                                                                                                   pp.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  #t0 =
                                                                                                                                  #t2) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Lock( pp,
                                                                                                                                         lpp,
                                                                                                                                         <
                                                                                                                                          ~n, 
                                                                                                                                          ~n.1
                                                                                                                                         >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t0 =
                                                                                                                                    #t.6) ∨
                                                                                                                                   (#t2 < #t0))) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           lpp,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t2 < #t0) ∨
                                                                                                                                   (#t2 =
                                                                                                                                    #t0)))))  ∥
                                                                                                                             (#vr.24 < #t.6)  ∥
                                                                                                                             (#t.6 =
                                                                                                                              #vr.24) )
                                                                                                                        case case_1
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      next
                                                                                                                        case case_2
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by solve( State_1111121111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq.1
                                                                    ) ▶₀ #t.5 )
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            by solve( State_1111121111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq.1
                                                      ) ▶₀ #t.5 )
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case eventRecvabm_0_111112111111_case_3
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                          case p_1_
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                            case p_1_
                            solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                              case p_1_
                              solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                case p_1_
                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                  case p_1_
                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                    case p_1_
                                    solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
                                           ) ▶₀ #t.5 )
                                      case p_1_1111121
                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                        case p_1_
                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                          case p_1_
                                          solve( (∃ #t.
                                                   (ProgressTo_11111211111111( ~prog_1111121111 ) @ #t))  ∥
                                                 (∃ #t. (ProgressTo_11111211112( ~prog_1111121111 ) @ #t)) )
                                            case case_1
                                            solve( State_1111121111111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq
                                                   ) ▶₀ #t.5 )
                                              case eventRecvabm_0_111112111111
                                              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                case p_1_
                                                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                  case p_1_
                                                  solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b,
                                                                         kEnc, kSign
                                                         ) ▶₀ #t.5 )
                                                    case p_1_1111121
                                                    solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                           ) ▶₀ #t.5 )
                                                      case p_1_
                                                      solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.5 )
                                                        case p_1_
                                                        solve( (∃ #t.
                                                                 (ProgressTo_11111211111111( ~prog_1111121111.1
                                                                  ) @ #t))  ∥
                                                               (∃ #t.
                                                                 (ProgressTo_11111211112( ~prog_1111121111.1
                                                                  ) @ #t)) )
                                                          case case_1
                                                          solve( State_1111121111111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq
                                                                 ) ▶₀ #t.5 )
                                                            case eventRecvabm_0_111112111111
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.6 )
                                                              case p_1_
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t.6 )
                                                                case p_1_
                                                                solve( State_11111211( ~prog_1.1,
                                                                                       ~prog_11111211.1, a, b,
                                                                                       kEnc, kSign
                                                                       ) ▶₀ #t.6 )
                                                                  case p_1_1111121
                                                                  solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.6 )
                                                                    case p_1_
                                                                    solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                         kSign
                                                                           ) ▶₀ #t.6 )
                                                                      case p_1_
                                                                      solve( !KU( senc(<(dif++x), m, pad, 
                                                                                        mac(<MH, SH, 
                                                                                             (dif++x), m, pad
                                                                                            >,
                                                                                            ~n.3)
                                                                                       >,
                                                                                       ~n.2)
                                                                             ) @ #vk.4 )
                                                                        case c_senc
                                                                        solve( !KU( senc(<(dif++dif++x), m2, 
                                                                                          pad.1, 
                                                                                          mac(<MH.1, SH.1, 
                                                                                               (dif++dif++x), 
                                                                                               m2, pad.1>,
                                                                                              ~n.3)
                                                                                         >,
                                                                                         ~n.2)
                                                                               ) @ #vk.9 )
                                                                          case c_senc
                                                                          by solve( !KU( ~n.2 ) @ #vk.11 )
                                                                        next
                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                 ) ▶₃ #j.1 )
                                                                            case MessageIDRule
                                                                            solve( State_111112111( ~prog_1.1,
                                                                                                    ~prog_11111211.2,
                                                                                                    a, b,
                                                                                                    ~n.2,
                                                                                                    kSign,
                                                                                                    lock
                                                                                   ) ▶₁ #j.1 )
                                                                              case lockba_0_11111211
                                                                              solve( ((#t.3 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.3 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t0 = #t.3) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.3)  ∥
                                                                                     (#t.3 = #vr.20) )
                                                                                case case_1
                                                                                solve( ((#t.4 < #vr.20) ∧
                                                                                        (∃ #t2.
                                                                                          (Unlock_1( '1',
                                                                                                     ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                           ) @ #t2)
                                                                                         ∧
                                                                                          (#t.4 < #t2) ∧
                                                                                          (#t2 < #vr.20) ∧
                                                                                          (∀ #t0 pp.
                                                                                            (Unlock( pp, ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            #t0 = #t2) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Lock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t0 = #t.4) ∨
                                                                                             (#t2 < #t0))) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Unlock( pp, lpp,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t2 < #t0) ∨
                                                                                             (#t2 =
                                                                                              #t0)))))  ∥
                                                                                       (#vr.20 < #t.4)  ∥
                                                                                       (#t.4 = #vr.20) )
                                                                                  case case_1
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.9 )
                                                                                                                    case p_1_
                                                                                                                    solve( (∃ #t.
                                                                                                                             (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                              ) @ #t))  ∥
                                                                                                                           (∃ #t.
                                                                                                                             (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                              ) @ #t)) )
                                                                                                                      case case_1
                                                                                                                      solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                  ~prog_11111211.3,
                                                                                                                                                  ~prog_1111121111.2,
                                                                                                                                                  MH.2,
                                                                                                                                                  SH.2,
                                                                                                                                                  a,
                                                                                                                                                  b,
                                                                                                                                                  kEnc,
                                                                                                                                                  kSign,
                                                                                                                                                  lock,
                                                                                                                                                  pad.2,
                                                                                                                                                  xmac,
                                                                                                                                                  m.1,
                                                                                                                                                  seq
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case eventRecvabm_0_111112111111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    next
                                                                                                                      case case_2
                                                                                                                      solve( State_1111121111( ~prog_1.1,
                                                                                                                                               ~prog_11111211.3,
                                                                                                                                               ~prog_1111121111.2,
                                                                                                                                               MH.2,
                                                                                                                                               SH.2,
                                                                                                                                               a,
                                                                                                                                               b,
                                                                                                                                               kEnc,
                                                                                                                                               kSign,
                                                                                                                                               lock,
                                                                                                                                               pad.2,
                                                                                                                                               xmac,
                                                                                                                                               m.1,
                                                                                                                                               seq
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           from formulas
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.2,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.3,
                                                                                                                     $SH.3,
                                                                                                                     $pad.3,
                                                                                                                     ~prog_1.2,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1,
                                                                                                                     m.2,
                                                                                                                     seq.1
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.2,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc.1,
                                                                                                                       kSign.1
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  by solve( State_1111121111111( ~prog_1.1,
                                                                                                                                 ~prog_11111211.3,
                                                                                                                                 ~prog_1111121111.3,
                                                                                                                                 MH.2,
                                                                                                                                 SH.2,
                                                                                                                                 ~n,
                                                                                                                                 ~n.1,
                                                                                                                                 kEnc,
                                                                                                                                 kSign,
                                                                                                                                 ~n.7,
                                                                                                                                 pad.2,
                                                                                                                                 xmac,
                                                                                                                                 m.1,
                                                                                                                                 seq
                                                                                                            ) ▶₀ #t2.1 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_3
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.8 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.8 )
                                                                                                                    case p_1_
                                                                                                                    by solve( !KU( ~n.2
                                                                                                                              ) @ #vk.11 )
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.2,
                                                                                                                   seq.1
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m.1,
                                                                                                                               seq
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      next
                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                               ) ▶₃ #j.1 )
                                                                          case MessageIDRule
                                                                          solve( State_111112111( ~prog_1.1,
                                                                                                  ~prog_11111211.2,
                                                                                                  a, b, ~n.2,
                                                                                                  kSign, lock
                                                                                 ) ▶₁ #j.1 )
                                                                            case lockba_0_11111211
                                                                            solve( ((#t.3 < #vr.20) ∧
                                                                                    (∃ #t2.
                                                                                      (Unlock_1( '1', ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                       ) @ #t2)
                                                                                     ∧
                                                                                      (#t.3 < #t2) ∧
                                                                                      (#t2 < #vr.20) ∧
                                                                                      (∀ #t0 pp.
                                                                                        (Unlock( pp, ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        #t0 = #t2) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Lock( pp, lpp,
                                                                                               <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t0 = #t.3) ∨
                                                                                         (#t2 < #t0))) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Unlock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t2 < #t0) ∨
                                                                                         (#t2 = #t0)))))  ∥
                                                                                   (#vr.20 < #t.3)  ∥
                                                                                   (#t.3 = #vr.20) )
                                                                              case case_1
                                                                              solve( ((#t.4 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.4 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t0 = #t.4) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.4)  ∥
                                                                                     (#t.4 = #vr.20) )
                                                                                case case_1
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.1,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.2,
                                                                                                                   $SH.2,
                                                                                                                   $pad.2,
                                                                                                                   ~prog_1.1,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign,
                                                                                                                   m,
                                                                                                                   seq
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.1,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                solve( State_111111( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.9 )
                                                                                                  case p_1_
                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111111( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111112( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_11111111( ~prog_1.1,
                                                                                                                               ~prog_11111111,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_1111111
                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_
                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111111( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111112( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( (∃ #t.
                                                                                                                           (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                            ) @ #t))  ∥
                                                                                                                         (∃ #t.
                                                                                                                           (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                            ) @ #t)) )
                                                                                                                    case case_1
                                                                                                                    solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                ~prog_11111211.3,
                                                                                                                                                ~prog_1111121111.2,
                                                                                                                                                MH.2,
                                                                                                                                                SH.2,
                                                                                                                                                a,
                                                                                                                                                b,
                                                                                                                                                kEnc,
                                                                                                                                                kSign,
                                                                                                                                                lock,
                                                                                                                                                pad.2,
                                                                                                                                                xmac,
                                                                                                                                                m,
                                                                                                                                                seq
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case eventRecvabm_0_111112111111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         cyclic
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  next
                                                                                                                    case case_2
                                                                                                                    solve( State_1111121111( ~prog_1.1,
                                                                                                                                             ~prog_11111211.3,
                                                                                                                                             ~prog_1111121111.2,
                                                                                                                                             MH.2,
                                                                                                                                             SH.2,
                                                                                                                                             a,
                                                                                                                                             b,
                                                                                                                                             kEnc,
                                                                                                                                             kSign,
                                                                                                                                             lock,
                                                                                                                                             pad.2,
                                                                                                                                             xmac,
                                                                                                                                             m,
                                                                                                                                             seq
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         from formulas
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.1,
                                                                                                                   seq.1
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m,
                                                                                                                               seq
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc.1,
                                                                                                     kSign.1
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.2,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.3,
                                                                                                                 $SH.3,
                                                                                                                 $pad.3,
                                                                                                                 ~prog_1.2,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1,
                                                                                                                 m.1,
                                                                                                                 seq.1
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.2,
                                                                                                                   ~prog_11111211.2,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              by solve( State_1111121111111( ~prog_1.1,
                                                                                                                             ~prog_11111211.3,
                                                                                                                             ~prog_1111121111.3,
                                                                                                                             MH.2,
                                                                                                                             SH.2,
                                                                                                                             ~n,
                                                                                                                             ~n.1,
                                                                                                                             kEnc,
                                                                                                                             kSign,
                                                                                                                             ~n.7,
                                                                                                                             pad.2,
                                                                                                                             xmac,
                                                                                                                             m,
                                                                                                                             seq
                                                                                                        ) ▶₀ #t2.1 )
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_3
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.1,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.2,
                                                                                                                 $SH.2,
                                                                                                                 $pad.2,
                                                                                                                 ~prog_1.1,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign,
                                                                                                                 m,
                                                                                                                 seq
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.1,
                                                                                                                   ~prog_11111211,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              solve( State_111111( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_111112( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                                             ~prog_11111111,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_1111111
                                                                                                        solve( State_111111( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_111112( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( !KU( senc(<
                                                                                                                                  (
                                                                                                                                   dif++
                                                                                                                                   dif++
                                                                                                                                   x
                                                                                                                                  ), 
                                                                                                                                  m2, 
                                                                                                                                  pad.1, 
                                                                                                                                  mac(<
                                                                                                                                       MH.1, 
                                                                                                                                       SH.1, 
                                                                                                                                       (
                                                                                                                                        dif++
                                                                                                                                        dif++
                                                                                                                                        x
                                                                                                                                       ), 
                                                                                                                                       m2, 
                                                                                                                                       pad.1
                                                                                                                                      >,
                                                                                                                                      ~n.3)
                                                                                                                                 >,
                                                                                                                                 ~n.2)
                                                                                                                       ) @ #vk.9 )
                                                                                                                  case c_senc
                                                                                                                  by solve( !KU( ~n.2
                                                                                                                            ) @ #vk.17 )
                                                                                                                next
                                                                                                                  case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                                                  solve( (¬(#vr.14 < #vr.22))  ∥
                                                                                                                         (∃ dif.1.
                                                                                                                           ((
                                                                                                                             dif++
                                                                                                                             dif++
                                                                                                                             x
                                                                                                                            ) =
                                                                                                                            (
                                                                                                                             dif++
                                                                                                                             x++
                                                                                                                             dif.1
                                                                                                                            ))) )
                                                                                                                    case case_2
                                                                                                                    solve( (¬(#vr.22 < #vr.14))  ∥
                                                                                                                           (∃ dif.1.
                                                                                                                             ((
                                                                                                                               dif++
                                                                                                                               x
                                                                                                                              ) =
                                                                                                                              (
                                                                                                                               dif++
                                                                                                                               dif++
                                                                                                                               x++
                                                                                                                               dif.1
                                                                                                                              ))) )
                                                                                                                      case case_1
                                                                                                                      solve( ((#t.6 < #vr.24) ∧
                                                                                                                              (∃ #t2.
                                                                                                                                (Unlock_0( '0',
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                 ) @ #t2)
                                                                                                                               ∧
                                                                                                                                (#t.6 < #t2) ∧
                                                                                                                                (#t2 < #vr.24) ∧
                                                                                                                                (∀ #t0
                                                                                                                                   pp.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  #t0 =
                                                                                                                                  #t2) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Lock( pp,
                                                                                                                                         lpp,
                                                                                                                                         <
                                                                                                                                          ~n, 
                                                                                                                                          ~n.1
                                                                                                                                         >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t0 =
                                                                                                                                    #t.6) ∨
                                                                                                                                   (#t2 < #t0))) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           lpp,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t2 < #t0) ∨
                                                                                                                                   (#t2 =
                                                                                                                                    #t0)))))  ∥
                                                                                                                             (#vr.24 < #t.6)  ∥
                                                                                                                             (#t.6 =
                                                                                                                              #vr.24) )
                                                                                                                        case case_1
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      next
                                                                                                                        case case_2
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by solve( State_1111121111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq
                                                                    ) ▶₀ #t.5 )
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            by solve( State_1111121111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq
                                                      ) ▶₀ #t.5 )
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case eventRecvabm_0_111112111111_case_4
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                          case p_1_
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                            case p_1_
                            solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                              case p_1_
                              solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                case p_1_
                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                  case p_1_
                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                    case p_1_
                                    solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
                                           ) ▶₀ #t.5 )
                                      case p_1_1111121
                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                        case p_1_
                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                          case p_1_
                                          solve( (∃ #t.
                                                   (ProgressTo_11111211111111( ~prog_1111121111 ) @ #t))  ∥
                                                 (∃ #t. (ProgressTo_11111211112( ~prog_1111121111 ) @ #t)) )
                                            case case_1
                                            solve( State_1111121111111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq.1
                                                   ) ▶₀ #t.5 )
                                              case eventRecvabm_0_111112111111
                                              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                case p_1_
                                                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                  case p_1_
                                                  solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b,
                                                                         kEnc, kSign
                                                         ) ▶₀ #t.5 )
                                                    case p_1_1111121
                                                    solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                           ) ▶₀ #t.5 )
                                                      case p_1_
                                                      solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.5 )
                                                        case p_1_
                                                        solve( (∃ #t.
                                                                 (ProgressTo_11111211111111( ~prog_1111121111.1
                                                                  ) @ #t))  ∥
                                                               (∃ #t.
                                                                 (ProgressTo_11111211112( ~prog_1111121111.1
                                                                  ) @ #t)) )
                                                          case case_1
                                                          solve( State_1111121111111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq.1
                                                                 ) ▶₀ #t.5 )
                                                            case eventRecvabm_0_111112111111
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.6 )
                                                              case p_1_
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t.6 )
                                                                case p_1_
                                                                solve( State_11111211( ~prog_1.1,
                                                                                       ~prog_11111211.1, a, b,
                                                                                       kEnc, kSign
                                                                       ) ▶₀ #t.6 )
                                                                  case p_1_1111121
                                                                  solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.6 )
                                                                    case p_1_
                                                                    solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                         kSign
                                                                           ) ▶₀ #t.6 )
                                                                      case p_1_
                                                                      solve( !KU( senc(<seq, m, pad, 
                                                                                        mac(<MH, SH, seq, m, 
                                                                                             pad>,
                                                                                            ~n.3)
                                                                                       >,
                                                                                       ~n.2)
                                                                             ) @ #vk.4 )
                                                                        case c_senc
                                                                        solve( !KU( senc(<(seq++seq++x), m2, 
                                                                                          pad.1, 
                                                                                          mac(<MH.1, SH.1, 
                                                                                               (seq++seq++x), 
                                                                                               m2, pad.1>,
                                                                                              ~n.3)
                                                                                         >,
                                                                                         ~n.2)
                                                                               ) @ #vk.9 )
                                                                          case c_senc
                                                                          by solve( !KU( ~n.2 ) @ #vk.11 )
                                                                        next
                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                 ) ▶₃ #j.1 )
                                                                            case MessageIDRule
                                                                            solve( State_111112111( ~prog_1.1,
                                                                                                    ~prog_11111211.2,
                                                                                                    a, b,
                                                                                                    ~n.2,
                                                                                                    kSign,
                                                                                                    lock
                                                                                   ) ▶₁ #j.1 )
                                                                              case lockba_0_11111211
                                                                              solve( ((#t.3 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.3 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t0 = #t.3) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.3)  ∥
                                                                                     (#t.3 = #vr.20) )
                                                                                case case_1
                                                                                solve( ((#t.4 < #vr.20) ∧
                                                                                        (∃ #t2.
                                                                                          (Unlock_1( '1',
                                                                                                     ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                           ) @ #t2)
                                                                                         ∧
                                                                                          (#t.4 < #t2) ∧
                                                                                          (#t2 < #vr.20) ∧
                                                                                          (∀ #t0 pp.
                                                                                            (Unlock( pp, ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            #t0 = #t2) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Lock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t0 = #t.4) ∨
                                                                                             (#t2 < #t0))) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Unlock( pp, lpp,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t2 < #t0) ∨
                                                                                             (#t2 =
                                                                                              #t0)))))  ∥
                                                                                       (#vr.20 < #t.4)  ∥
                                                                                       (#t.4 = #vr.20) )
                                                                                  case case_1
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq.1
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.9 )
                                                                                                                    case p_1_
                                                                                                                    solve( (∃ #t.
                                                                                                                             (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                              ) @ #t))  ∥
                                                                                                                           (∃ #t.
                                                                                                                             (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                              ) @ #t)) )
                                                                                                                      case case_1
                                                                                                                      solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                  ~prog_11111211.3,
                                                                                                                                                  ~prog_1111121111.2,
                                                                                                                                                  MH.2,
                                                                                                                                                  SH.2,
                                                                                                                                                  a,
                                                                                                                                                  b,
                                                                                                                                                  kEnc,
                                                                                                                                                  kSign,
                                                                                                                                                  lock,
                                                                                                                                                  pad.2,
                                                                                                                                                  xmac,
                                                                                                                                                  m.1,
                                                                                                                                                  seq.1
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case eventRecvabm_0_111112111111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    next
                                                                                                                      case case_2
                                                                                                                      solve( State_1111121111( ~prog_1.1,
                                                                                                                                               ~prog_11111211.3,
                                                                                                                                               ~prog_1111121111.2,
                                                                                                                                               MH.2,
                                                                                                                                               SH.2,
                                                                                                                                               a,
                                                                                                                                               b,
                                                                                                                                               kEnc,
                                                                                                                                               kSign,
                                                                                                                                               lock,
                                                                                                                                               pad.2,
                                                                                                                                               xmac,
                                                                                                                                               m.1,
                                                                                                                                               seq.1
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           from formulas
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.2,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.3,
                                                                                                                     $SH.3,
                                                                                                                     $pad.3,
                                                                                                                     ~prog_1.2,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1,
                                                                                                                     m.2,
                                                                                                                     seq.2
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.2,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc.1,
                                                                                                                       kSign.1
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  by solve( State_1111121111111( ~prog_1.1,
                                                                                                                                 ~prog_11111211.3,
                                                                                                                                 ~prog_1111121111.3,
                                                                                                                                 MH.2,
                                                                                                                                 SH.2,
                                                                                                                                 ~n,
                                                                                                                                 ~n.1,
                                                                                                                                 kEnc,
                                                                                                                                 kSign,
                                                                                                                                 ~n.7,
                                                                                                                                 pad.2,
                                                                                                                                 xmac,
                                                                                                                                 m.1,
                                                                                                                                 seq.1
                                                                                                            ) ▶₀ #t2.1 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_3
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq.1
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.8 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.8 )
                                                                                                                    case p_1_
                                                                                                                    by solve( !KU( ~n.2
                                                                                                                              ) @ #vk.11 )
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.2,
                                                                                                                   seq.2
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m.1,
                                                                                                                               seq.1
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      next
                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                               ) ▶₃ #j.1 )
                                                                          case MessageIDRule
                                                                          solve( State_111112111( ~prog_1.1,
                                                                                                  ~prog_11111211.2,
                                                                                                  a, b, ~n.2,
                                                                                                  kSign, lock
                                                                                 ) ▶₁ #j.1 )
                                                                            case lockba_0_11111211
                                                                            solve( ((#t.3 < #vr.20) ∧
                                                                                    (∃ #t2.
                                                                                      (Unlock_1( '1', ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                       ) @ #t2)
                                                                                     ∧
                                                                                      (#t.3 < #t2) ∧
                                                                                      (#t2 < #vr.20) ∧
                                                                                      (∀ #t0 pp.
                                                                                        (Unlock( pp, ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        #t0 = #t2) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Lock( pp, lpp,
                                                                                               <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t0 = #t.3) ∨
                                                                                         (#t2 < #t0))) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Unlock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t2 < #t0) ∨
                                                                                         (#t2 = #t0)))))  ∥
                                                                                   (#vr.20 < #t.3)  ∥
                                                                                   (#t.3 = #vr.20) )
                                                                              case case_1
                                                                              solve( ((#t.4 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.4 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t0 = #t.4) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.4)  ∥
                                                                                     (#t.4 = #vr.20) )
                                                                                case case_1
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.1,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.2,
                                                                                                                   $SH.2,
                                                                                                                   $pad.2,
                                                                                                                   ~prog_1.1,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign,
                                                                                                                   m,
                                                                                                                   seq.1
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.1,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                solve( State_111111( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.9 )
                                                                                                  case p_1_
                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111111( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111112( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_11111111( ~prog_1.1,
                                                                                                                               ~prog_11111111,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_1111111
                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_
                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111111( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111112( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( (∃ #t.
                                                                                                                           (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                            ) @ #t))  ∥
                                                                                                                         (∃ #t.
                                                                                                                           (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                            ) @ #t)) )
                                                                                                                    case case_1
                                                                                                                    solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                ~prog_11111211.3,
                                                                                                                                                ~prog_1111121111.2,
                                                                                                                                                MH.2,
                                                                                                                                                SH.2,
                                                                                                                                                a,
                                                                                                                                                b,
                                                                                                                                                kEnc,
                                                                                                                                                kSign,
                                                                                                                                                lock,
                                                                                                                                                pad.2,
                                                                                                                                                xmac,
                                                                                                                                                m,
                                                                                                                                                seq.1
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case eventRecvabm_0_111112111111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         cyclic
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  next
                                                                                                                    case case_2
                                                                                                                    solve( State_1111121111( ~prog_1.1,
                                                                                                                                             ~prog_11111211.3,
                                                                                                                                             ~prog_1111121111.2,
                                                                                                                                             MH.2,
                                                                                                                                             SH.2,
                                                                                                                                             a,
                                                                                                                                             b,
                                                                                                                                             kEnc,
                                                                                                                                             kSign,
                                                                                                                                             lock,
                                                                                                                                             pad.2,
                                                                                                                                             xmac,
                                                                                                                                             m,
                                                                                                                                             seq.1
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         from formulas
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.1,
                                                                                                                   seq.2
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m,
                                                                                                                               seq.1
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc.1,
                                                                                                     kSign.1
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.2,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.3,
                                                                                                                 $SH.3,
                                                                                                                 $pad.3,
                                                                                                                 ~prog_1.2,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1,
                                                                                                                 m.1,
                                                                                                                 seq.2
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.2,
                                                                                                                   ~prog_11111211.2,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              by solve( State_1111121111111( ~prog_1.1,
                                                                                                                             ~prog_11111211.3,
                                                                                                                             ~prog_1111121111.3,
                                                                                                                             MH.2,
                                                                                                                             SH.2,
                                                                                                                             ~n,
                                                                                                                             ~n.1,
                                                                                                                             kEnc,
                                                                                                                             kSign,
                                                                                                                             ~n.7,
                                                                                                                             pad.2,
                                                                                                                             xmac,
                                                                                                                             m,
                                                                                                                             seq.1
                                                                                                        ) ▶₀ #t2.1 )
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_3
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.1,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.2,
                                                                                                                 $SH.2,
                                                                                                                 $pad.2,
                                                                                                                 ~prog_1.1,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign,
                                                                                                                 m,
                                                                                                                 seq.1
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.1,
                                                                                                                   ~prog_11111211,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              solve( State_111111( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_111112( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                                             ~prog_11111111,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_1111111
                                                                                                        solve( State_111111( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_111112( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( !KU( senc(<
                                                                                                                                  (
                                                                                                                                   seq++
                                                                                                                                   seq++
                                                                                                                                   x
                                                                                                                                  ), 
                                                                                                                                  m2, 
                                                                                                                                  pad.1, 
                                                                                                                                  mac(<
                                                                                                                                       MH.1, 
                                                                                                                                       SH.1, 
                                                                                                                                       (
                                                                                                                                        seq++
                                                                                                                                        seq++
                                                                                                                                        x
                                                                                                                                       ), 
                                                                                                                                       m2, 
                                                                                                                                       pad.1
                                                                                                                                      >,
                                                                                                                                      ~n.3)
                                                                                                                                 >,
                                                                                                                                 ~n.2)
                                                                                                                       ) @ #vk.9 )
                                                                                                                  case c_senc
                                                                                                                  by solve( !KU( ~n.2
                                                                                                                            ) @ #vk.15 )
                                                                                                                next
                                                                                                                  case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                                                  solve( (¬(#vr.14 < #vr.22))  ∥
                                                                                                                         (∃ dif.
                                                                                                                           ((
                                                                                                                             seq++
                                                                                                                             seq++
                                                                                                                             x
                                                                                                                            ) =
                                                                                                                            (
                                                                                                                             dif++
                                                                                                                             seq
                                                                                                                            ))) )
                                                                                                                    case case_2
                                                                                                                    solve( (¬(#vr.22 < #vr.14))  ∥
                                                                                                                           (∃ dif.
                                                                                                                             (seq =
                                                                                                                              (
                                                                                                                               dif++
                                                                                                                               seq++
                                                                                                                               seq++
                                                                                                                               x
                                                                                                                              ))) )
                                                                                                                      case case_1
                                                                                                                      solve( ((#t.6 < #vr.24) ∧
                                                                                                                              (∃ #t2.
                                                                                                                                (Unlock_0( '0',
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                 ) @ #t2)
                                                                                                                               ∧
                                                                                                                                (#t.6 < #t2) ∧
                                                                                                                                (#t2 < #vr.24) ∧
                                                                                                                                (∀ #t0
                                                                                                                                   pp.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  #t0 =
                                                                                                                                  #t2) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Lock( pp,
                                                                                                                                         lpp,
                                                                                                                                         <
                                                                                                                                          ~n, 
                                                                                                                                          ~n.1
                                                                                                                                         >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t0 =
                                                                                                                                    #t.6) ∨
                                                                                                                                   (#t2 < #t0))) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           lpp,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t2 < #t0) ∨
                                                                                                                                   (#t2 =
                                                                                                                                    #t0)))))  ∥
                                                                                                                             (#vr.24 < #t.6)  ∥
                                                                                                                             (#t.6 =
                                                                                                                              #vr.24) )
                                                                                                                        case case_1
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      next
                                                                                                                        case case_2
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by solve( State_1111121111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq.1
                                                                    ) ▶₀ #t.5 )
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            by solve( State_1111121111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq.1
                                                      ) ▶₀ #t.5 )
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case eventRecvabm_0_111112111111_case_5
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                          case p_1_
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                            case p_1_
                            solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                              case p_1_
                              solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                case p_1_
                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                  case p_1_
                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                    case p_1_
                                    solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
                                           ) ▶₀ #t.5 )
                                      case p_1_1111121
                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                        case p_1_
                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                          case p_1_
                                          solve( (∃ #t.
                                                   (ProgressTo_11111211111111( ~prog_1111121111 ) @ #t))  ∥
                                                 (∃ #t. (ProgressTo_11111211112( ~prog_1111121111 ) @ #t)) )
                                            case case_1
                                            solve( State_1111121111111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq
                                                   ) ▶₀ #t.5 )
                                              case eventRecvabm_0_111112111111
                                              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                case p_1_
                                                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                  case p_1_
                                                  solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b,
                                                                         kEnc, kSign
                                                         ) ▶₀ #t.5 )
                                                    case p_1_1111121
                                                    solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                           ) ▶₀ #t.5 )
                                                      case p_1_
                                                      solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t.5 )
                                                        case p_1_
                                                        solve( (∃ #t.
                                                                 (ProgressTo_11111211111111( ~prog_1111121111.1
                                                                  ) @ #t))  ∥
                                                               (∃ #t.
                                                                 (ProgressTo_11111211112( ~prog_1111121111.1
                                                                  ) @ #t)) )
                                                          case case_1
                                                          solve( State_1111121111111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq
                                                                 ) ▶₀ #t.5 )
                                                            case eventRecvabm_0_111112111111
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t.6 )
                                                              case p_1_
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t.6 )
                                                                case p_1_
                                                                solve( State_11111211( ~prog_1.1,
                                                                                       ~prog_11111211.1, a, b,
                                                                                       kEnc, kSign
                                                                       ) ▶₀ #t.6 )
                                                                  case p_1_1111121
                                                                  solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t.6 )
                                                                    case p_1_
                                                                    solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                         kSign
                                                                           ) ▶₀ #t.6 )
                                                                      case p_1_
                                                                      solve( !KU( senc(<(x++x.1), m, pad, 
                                                                                        mac(<MH, SH, 
                                                                                             (x++x.1), m, pad
                                                                                            >,
                                                                                            ~n.3)
                                                                                       >,
                                                                                       ~n.2)
                                                                             ) @ #vk.4 )
                                                                        case c_senc
                                                                        solve( !KU( senc(<(x++x.1++x.1++x.2), 
                                                                                          m2, pad.1, 
                                                                                          mac(<MH.1, SH.1, 
                                                                                               (x++x.1++x.1++
                                                                                                x.2), 
                                                                                               m2, pad.1>,
                                                                                              ~n.3)
                                                                                         >,
                                                                                         ~n.2)
                                                                               ) @ #vk.9 )
                                                                          case c_senc
                                                                          by solve( !KU( ~n.2 ) @ #vk.11 )
                                                                        next
                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                 ) ▶₃ #j.1 )
                                                                            case MessageIDRule
                                                                            solve( State_111112111( ~prog_1.1,
                                                                                                    ~prog_11111211.2,
                                                                                                    a, b,
                                                                                                    ~n.2,
                                                                                                    kSign,
                                                                                                    lock
                                                                                   ) ▶₁ #j.1 )
                                                                              case lockba_0_11111211
                                                                              solve( ((#t.3 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.3 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.4,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t0 = #t.3) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.3) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.3)  ∥
                                                                                     (#t.3 = #vr.20) )
                                                                                case case_1
                                                                                solve( ((#t.4 < #vr.20) ∧
                                                                                        (∃ #t2.
                                                                                          (Unlock_1( '1',
                                                                                                     ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                           ) @ #t2)
                                                                                         ∧
                                                                                          (#t.4 < #t2) ∧
                                                                                          (#t2 < #vr.20) ∧
                                                                                          (∀ #t0 pp.
                                                                                            (Unlock( pp, ~n.5,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            #t0 = #t2) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Lock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t0 = #t.4) ∨
                                                                                             (#t2 < #t0))) ∧
                                                                                          (∀ pp lpp #t0.
                                                                                            (Unlock( pp, lpp,
                                                                                                     <~n.1, ~n
                                                                                                     >
                                                                                             ) @ #t0)
                                                                                           ⇒
                                                                                            ((#t0 < #t.4) ∨
                                                                                             (#t2 < #t0) ∨
                                                                                             (#t2 =
                                                                                              #t0)))))  ∥
                                                                                       (#vr.20 < #t.4)  ∥
                                                                                       (#t.4 = #vr.20) )
                                                                                  case case_1
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.9 )
                                                                                                                    case p_1_
                                                                                                                    solve( (∃ #t.
                                                                                                                             (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                              ) @ #t))  ∥
                                                                                                                           (∃ #t.
                                                                                                                             (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                              ) @ #t)) )
                                                                                                                      case case_1
                                                                                                                      solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                  ~prog_11111211.3,
                                                                                                                                                  ~prog_1111121111.2,
                                                                                                                                                  MH.2,
                                                                                                                                                  SH.2,
                                                                                                                                                  a,
                                                                                                                                                  b,
                                                                                                                                                  kEnc,
                                                                                                                                                  kSign,
                                                                                                                                                  lock,
                                                                                                                                                  pad.2,
                                                                                                                                                  xmac,
                                                                                                                                                  m.1,
                                                                                                                                                  seq
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case eventRecvabm_0_111112111111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    next
                                                                                                                      case case_2
                                                                                                                      solve( State_1111121111( ~prog_1.1,
                                                                                                                                               ~prog_11111211.3,
                                                                                                                                               ~prog_1111121111.2,
                                                                                                                                               MH.2,
                                                                                                                                               SH.2,
                                                                                                                                               a,
                                                                                                                                               b,
                                                                                                                                               kEnc,
                                                                                                                                               kSign,
                                                                                                                                               lock,
                                                                                                                                               pad.2,
                                                                                                                                               xmac,
                                                                                                                                               m.1,
                                                                                                                                               seq
                                                                                                                             ) ▶₀ #t.9 )
                                                                                                                        case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           from formulas
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.2,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.3,
                                                                                                                     $SH.3,
                                                                                                                     $pad.3,
                                                                                                                     ~prog_1.2,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1,
                                                                                                                     m.2,
                                                                                                                     seq.1
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.2,
                                                                                                                       ~prog_11111211.2,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc.1,
                                                                                                                       kSign.1
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  by solve( State_1111121111111( ~prog_1.1,
                                                                                                                                 ~prog_11111211.3,
                                                                                                                                 ~prog_1111121111.3,
                                                                                                                                 MH.2,
                                                                                                                                 SH.2,
                                                                                                                                 ~n,
                                                                                                                                 ~n.1,
                                                                                                                                 kEnc,
                                                                                                                                 kSign,
                                                                                                                                 ~n.7,
                                                                                                                                 pad.2,
                                                                                                                                 xmac,
                                                                                                                                 m.1,
                                                                                                                                 seq
                                                                                                            ) ▶₀ #t2.1 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                next
                                                                                  case case_3
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_
                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                             ~prog_11111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t.6 )
                                                                                        case p_1_1111111
                                                                                        solve( State_11111111111111( $MH.2,
                                                                                                                     $SH.2,
                                                                                                                     $pad.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111111.1,
                                                                                                                     ~prog_1111111111,
                                                                                                                     lock,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m.1,
                                                                                                                     seq
                                                                                               ) ▶₀ #t.7 )
                                                                                          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                          solve( MID_Receiver( ~mid_1111111111111
                                                                                                 ) ▶₃ #j.2 )
                                                                                            case MessageIDRule
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_11111211( ~prog_1.1,
                                                                                                                       ~prog_11111211.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_1111121
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_11111111( ~prog_1.1,
                                                                                                                                 ~prog_11111111,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_1111111
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.8 )
                                                                                                                  case p_1_
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t.8 )
                                                                                                                    case p_1_
                                                                                                                    by solve( !KU( ~n.2
                                                                                                                              ) @ #vk.11 )
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.2,
                                                                                                                   seq.1
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m.1,
                                                                                                                               seq
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      next
                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                               ) ▶₃ #j.1 )
                                                                          case MessageIDRule
                                                                          solve( State_111112111( ~prog_1.1,
                                                                                                  ~prog_11111211.2,
                                                                                                  a, b, ~n.2,
                                                                                                  kSign, lock
                                                                                 ) ▶₁ #j.1 )
                                                                            case lockba_0_11111211
                                                                            solve( ((#t.3 < #vr.20) ∧
                                                                                    (∃ #t2.
                                                                                      (Unlock_1( '1', ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                       ) @ #t2)
                                                                                     ∧
                                                                                      (#t.3 < #t2) ∧
                                                                                      (#t2 < #vr.20) ∧
                                                                                      (∀ #t0 pp.
                                                                                        (Unlock( pp, ~n.4,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        #t0 = #t2) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Lock( pp, lpp,
                                                                                               <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t0 = #t.3) ∨
                                                                                         (#t2 < #t0))) ∧
                                                                                      (∀ pp lpp #t0.
                                                                                        (Unlock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                         ) @ #t0)
                                                                                       ⇒
                                                                                        ((#t0 < #t.3) ∨
                                                                                         (#t2 < #t0) ∨
                                                                                         (#t2 = #t0)))))  ∥
                                                                                   (#vr.20 < #t.3)  ∥
                                                                                   (#t.3 = #vr.20) )
                                                                              case case_1
                                                                              solve( ((#t.4 < #vr.20) ∧
                                                                                      (∃ #t2.
                                                                                        (Unlock_1( '1', ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                         ) @ #t2)
                                                                                       ∧
                                                                                        (#t.4 < #t2) ∧
                                                                                        (#t2 < #vr.20) ∧
                                                                                        (∀ #t0 pp.
                                                                                          (Unlock( pp, ~n.6,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          #t0 = #t2) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Lock( pp, lpp,
                                                                                                 <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t0 = #t.4) ∨
                                                                                           (#t2 < #t0))) ∧
                                                                                        (∀ pp lpp #t0.
                                                                                          (Unlock( pp, lpp,
                                                                                                   <~n.1, ~n>
                                                                                           ) @ #t0)
                                                                                         ⇒
                                                                                          ((#t0 < #t.4) ∨
                                                                                           (#t2 < #t0) ∨
                                                                                           (#t2 = #t0)))))  ∥
                                                                                     (#vr.20 < #t.4)  ∥
                                                                                     (#t.4 = #vr.20) )
                                                                                case case_1
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.1,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.2,
                                                                                                                   $SH.2,
                                                                                                                   $pad.2,
                                                                                                                   ~prog_1.1,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign,
                                                                                                                   m,
                                                                                                                   seq
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.1,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                solve( State_111111( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.9 )
                                                                                                  case p_1_
                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.9 )
                                                                                                    case p_1_
                                                                                                    solve( State_111111( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.9 )
                                                                                                      case p_1_
                                                                                                      solve( State_111112( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.9 )
                                                                                                        case p_1_
                                                                                                        solve( State_11111111( ~prog_1.1,
                                                                                                                               ~prog_11111111,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                               ) ▶₀ #t.9 )
                                                                                                          case p_1_1111111
                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.9 )
                                                                                                            case p_1_
                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.9 )
                                                                                                              case p_1_
                                                                                                              solve( State_111111( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.9 )
                                                                                                                case p_1_
                                                                                                                solve( State_111112( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t.9 )
                                                                                                                  case p_1_
                                                                                                                  solve( (∃ #t.
                                                                                                                           (ProgressTo_11111211111111( ~prog_1111121111.2
                                                                                                                            ) @ #t))  ∥
                                                                                                                         (∃ #t.
                                                                                                                           (ProgressTo_11111211112( ~prog_1111121111.2
                                                                                                                            ) @ #t)) )
                                                                                                                    case case_1
                                                                                                                    solve( State_1111121111111( ~prog_1.1,
                                                                                                                                                ~prog_11111211.3,
                                                                                                                                                ~prog_1111121111.2,
                                                                                                                                                MH.2,
                                                                                                                                                SH.2,
                                                                                                                                                a,
                                                                                                                                                b,
                                                                                                                                                kEnc,
                                                                                                                                                kSign,
                                                                                                                                                lock,
                                                                                                                                                pad.2,
                                                                                                                                                xmac,
                                                                                                                                                m,
                                                                                                                                                seq
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case eventRecvabm_0_111112111111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         cyclic
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  next
                                                                                                                    case case_2
                                                                                                                    solve( State_1111121111( ~prog_1.1,
                                                                                                                                             ~prog_11111211.3,
                                                                                                                                             ~prog_1111121111.2,
                                                                                                                                             MH.2,
                                                                                                                                             SH.2,
                                                                                                                                             a,
                                                                                                                                             b,
                                                                                                                                             kEnc,
                                                                                                                                             kSign,
                                                                                                                                             lock,
                                                                                                                                             pad.2,
                                                                                                                                             xmac,
                                                                                                                                             m,
                                                                                                                                             seq
                                                                                                                           ) ▶₀ #t.9 )
                                                                                                                      case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                      by contradiction
                                                                                                                         /*
                                                                                                                         from formulas
                                                                                                                         */
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc.1,
                                                                                                       kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_
                                                                                    solve( State_11111111( ~prog_1.2,
                                                                                                           ~prog_11111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc.1,
                                                                                                           kSign.1
                                                                                           ) ▶₀ #t.6 )
                                                                                      case p_1_1111111
                                                                                      solve( State_11111111111111( $MH.3,
                                                                                                                   $SH.3,
                                                                                                                   $pad.3,
                                                                                                                   ~prog_1.2,
                                                                                                                   ~prog_11111111.1,
                                                                                                                   ~prog_1111111111,
                                                                                                                   lock,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1,
                                                                                                                   m.1,
                                                                                                                   seq.1
                                                                                             ) ▶₀ #t.7 )
                                                                                        case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                        solve( MID_Receiver( ~mid_1111111111111
                                                                                               ) ▶₃ #j.2 )
                                                                                          case MessageIDRule
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_
                                                                                              solve( State_11111211( ~prog_1.2,
                                                                                                                     ~prog_11111211.2,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc.1,
                                                                                                                     kSign.1
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_1111121
                                                                                                by solve( State_1111121111111( ~prog_1.1,
                                                                                                                               ~prog_11111211.3,
                                                                                                                               ~prog_1111121111.3,
                                                                                                                               MH.2,
                                                                                                                               SH.2,
                                                                                                                               ~n,
                                                                                                                               ~n.1,
                                                                                                                               kEnc,
                                                                                                                               kSign,
                                                                                                                               ~n.7,
                                                                                                                               pad.2,
                                                                                                                               xmac,
                                                                                                                               m,
                                                                                                                               seq
                                                                                                          ) ▶₀ #t2.1 )
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc.1,
                                                                                                     kSign.1
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.2,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc.1,
                                                                                                         kSign.1
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.3,
                                                                                                                 $SH.3,
                                                                                                                 $pad.3,
                                                                                                                 ~prog_1.2,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc.1,
                                                                                                                 kSign.1,
                                                                                                                 m.1,
                                                                                                                 seq.1
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc.1,
                                                                                                             kSign.1
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc.1,
                                                                                                               kSign.1
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.2,
                                                                                                                   ~prog_11111211.2,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc.1,
                                                                                                                   kSign.1
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              by solve( State_1111121111111( ~prog_1.1,
                                                                                                                             ~prog_11111211.3,
                                                                                                                             ~prog_1111121111.3,
                                                                                                                             MH.2,
                                                                                                                             SH.2,
                                                                                                                             ~n,
                                                                                                                             ~n.1,
                                                                                                                             kEnc,
                                                                                                                             kSign,
                                                                                                                             ~n.7,
                                                                                                                             pad.2,
                                                                                                                             xmac,
                                                                                                                             m,
                                                                                                                             seq
                                                                                                        ) ▶₀ #t2.1 )
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_3
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.6 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.6 )
                                                                                  case p_1_
                                                                                  solve( State_11111111( ~prog_1.1,
                                                                                                         ~prog_11111111,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                         ) ▶₀ #t.6 )
                                                                                    case p_1_1111111
                                                                                    solve( State_11111111111111( $MH.2,
                                                                                                                 $SH.2,
                                                                                                                 $pad.2,
                                                                                                                 ~prog_1.1,
                                                                                                                 ~prog_11111111.1,
                                                                                                                 ~prog_1111111111,
                                                                                                                 lock,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign,
                                                                                                                 m,
                                                                                                                 seq
                                                                                           ) ▶₀ #t.7 )
                                                                                      case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                      solve( MID_Receiver( ~mid_1111111111111
                                                                                             ) ▶₃ #j.2 )
                                                                                        case MessageIDRule
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t.8 )
                                                                                          case p_1_
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t.8 )
                                                                                            case p_1_
                                                                                            solve( State_11111211( ~prog_1.1,
                                                                                                                   ~prog_11111211,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                   ) ▶₀ #t.8 )
                                                                                              case p_1_1111121
                                                                                              solve( State_111111( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.8 )
                                                                                                case p_1_
                                                                                                solve( State_111112( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t.8 )
                                                                                                  case p_1_
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t.8 )
                                                                                                    case p_1_
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.8 )
                                                                                                      case p_1_
                                                                                                      solve( State_11111111( ~prog_1.1,
                                                                                                                             ~prog_11111111,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                             ) ▶₀ #t.8 )
                                                                                                        case p_1_1111111
                                                                                                        solve( State_111111( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t.8 )
                                                                                                          case p_1_
                                                                                                          solve( State_111112( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.8 )
                                                                                                            case p_1_
                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.8 )
                                                                                                              case p_1_
                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                   a,
                                                                                                                                   b,
                                                                                                                                   kEnc,
                                                                                                                                   kSign
                                                                                                                     ) ▶₀ #t.8 )
                                                                                                                case p_1_
                                                                                                                solve( !KU( senc(<
                                                                                                                                  (
                                                                                                                                   x++
                                                                                                                                   x.1++
                                                                                                                                   x.1++
                                                                                                                                   x.2
                                                                                                                                  ), 
                                                                                                                                  m2, 
                                                                                                                                  pad.1, 
                                                                                                                                  mac(<
                                                                                                                                       MH.1, 
                                                                                                                                       SH.1, 
                                                                                                                                       (
                                                                                                                                        x++
                                                                                                                                        x.1++
                                                                                                                                        x.1++
                                                                                                                                        x.2
                                                                                                                                       ), 
                                                                                                                                       m2, 
                                                                                                                                       pad.1
                                                                                                                                      >,
                                                                                                                                      ~n.3)
                                                                                                                                 >,
                                                                                                                                 ~n.2)
                                                                                                                       ) @ #vk.9 )
                                                                                                                  case c_senc
                                                                                                                  by solve( !KU( ~n.2
                                                                                                                            ) @ #vk.17 )
                                                                                                                next
                                                                                                                  case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                                                                                                                  solve( (¬(#vr.14 < #vr.22))  ∥
                                                                                                                         (∃ dif.
                                                                                                                           ((
                                                                                                                             x++
                                                                                                                             x.1++
                                                                                                                             x.1++
                                                                                                                             x.2
                                                                                                                            ) =
                                                                                                                            (
                                                                                                                             dif++
                                                                                                                             x++
                                                                                                                             x.1
                                                                                                                            ))) )
                                                                                                                    case case_2
                                                                                                                    solve( (¬(#vr.22 < #vr.14))  ∥
                                                                                                                           (∃ dif.
                                                                                                                             ((
                                                                                                                               x++
                                                                                                                               x.1
                                                                                                                              ) =
                                                                                                                              (
                                                                                                                               dif++
                                                                                                                               x++
                                                                                                                               x.1++
                                                                                                                               x.1++
                                                                                                                               x.2
                                                                                                                              ))) )
                                                                                                                      case case_1
                                                                                                                      solve( ((#t.6 < #vr.24) ∧
                                                                                                                              (∃ #t2.
                                                                                                                                (Unlock_0( '0',
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                 ) @ #t2)
                                                                                                                               ∧
                                                                                                                                (#t.6 < #t2) ∧
                                                                                                                                (#t2 < #vr.24) ∧
                                                                                                                                (∀ #t0
                                                                                                                                   pp.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           ~n.8,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  #t0 =
                                                                                                                                  #t2) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Lock( pp,
                                                                                                                                         lpp,
                                                                                                                                         <
                                                                                                                                          ~n, 
                                                                                                                                          ~n.1
                                                                                                                                         >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t0 =
                                                                                                                                    #t.6) ∨
                                                                                                                                   (#t2 < #t0))) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           lpp,
                                                                                                                                           <
                                                                                                                                            ~n, 
                                                                                                                                            ~n.1
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #t.6) ∨
                                                                                                                                   (#t2 < #t0) ∨
                                                                                                                                   (#t2 =
                                                                                                                                    #t0)))))  ∥
                                                                                                                             (#vr.24 < #t.6)  ∥
                                                                                                                             (#t.6 =
                                                                                                                              #vr.24) )
                                                                                                                        case case_1
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      next
                                                                                                                        case case_2
                                                                                                                        by contradiction
                                                                                                                           /*
                                                                                                                           cyclic
                                                                                                                           */
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_2
                                                          by solve( State_1111121111( ~prog_1.1,
                                                                                      ~prog_11111211.2,
                                                                                      ~prog_1111121111.1,
                                                                                      MH.2, SH.2, a, b, kEnc,
                                                                                      kSign, lock, pad.2,
                                                                                      xmac, m.1, seq
                                                                    ) ▶₀ #t.5 )
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            by solve( State_1111121111( ~prog_1.1, ~prog_11111211.2,
                                                                        ~prog_1111121111, MH.2, SH.2, a, b,
                                                                        kEnc, kSign, lock, pad.2, xmac, m.1,
                                                                        seq
                                                      ) ▶₀ #t.5 )
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case case_2
          by contradiction /* cyclic */
        qed
      qed
    qed
  qed
qed

lemma delivery_wo_order:
  all-traces
  "∀ A B m #i.
    (Sent( A, B, m ) @ #i) ⇒ (∃ #k. (Recv( A, B, m ) @ #k) ∧ (#i < #k))"
/*
guarded formula characterizing all counter-examples:
"∃ A B m #i.
  (Sent( A, B, m ) @ #i) ∧ ∀ #k. (Recv( A, B, m ) @ #k) ⇒ ¬(#i < #k)"
*/
simplify
solve( State_111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111,
                           lock, A, B, kEnc, kSign, m, seq
       ) ▶₀ #i )
  case eventSeqSentabseq_0_1111111111
  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.1 )
    case p_1_
    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.2 )
      case p_1_
      solve( State_11111111( ~prog_1.1, ~prog_11111111, a, b, kEnc, kSign
             ) ▶₀ #t.3 )
        case p_1_1111111
        solve( State_11111111111111( $MH, $SH, $pad, ~prog_1.1, ~prog_11111111.1,
                                     ~prog_1111111111, lock, a, b, kEnc, kSign, m, seq.1
               ) ▶₀ #t.3 )
          case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
          solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j )
            case MessageIDRule
            solve( State_111111( ~prog_1, a.1, b.1, kEnc, kSign.1 ) ▶₀ #t.4 )
              case p_1_
              solve( State_111112( ~prog_1, a.1, b.1, kEnc, kSign.1 ) ▶₀ #t.4 )
                case p_1_
                solve( State_111112111( ~prog_1.1, ~prog_11111211, a, b, ~n.3, kSign,
                                        lock
                       ) ▶₁ #j )
                  case lockba_0_11111211
                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
                    case p_1_
                    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
                      case p_1_
                      solve( State_11111111( ~prog_1.1, ~prog_11111111, a, b, kEnc, kSign
                             ) ▶₀ #t.4 )
                        case p_1_1111111
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
                          case p_1_
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.4 )
                            case p_1_
                            solve( State_11111211( ~prog_1.1, ~prog_11111211, a, b, kEnc, kSign
                                   ) ▶₀ #t.4 )
                              case p_1_1111121
                              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                case p_1_
                                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                  case p_1_
                                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                    case p_1_
                                    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                      case p_1_
                                      solve( (∃ #t. (ProgressTo_11111211111111( ~prog_1111121111 ) @ #t))  ∥
                                             (∃ #t. (ProgressTo_11111211112( ~prog_1111121111 ) @ #t)) )
                                        case case_1
                                        solve( State_1111121111111( ~prog_1.1, ~prog_11111211.1,
                                                                    ~prog_1111121111, MH.1, SH.1, a, b, kEnc,
                                                                    kSign, lock, pad.1, xmac, m, seq.1
                                               ) ▶₀ #t.5 )
                                          case eventRecvabm_0_111112111111
                                          by contradiction /* from formulas */
                                        qed
                                      next
                                        case case_2
                                        solve( State_1111121111( ~prog_1.1, ~prog_11111211.1,
                                                                 ~prog_1111121111, MH.1, SH.1, a, b, kEnc,
                                                                 kSign, lock, pad.1, xmac, m, seq.1
                                               ) ▶₀ #t.5 )
                                          case inrMHSHsencseqmpadxmackEnc_0_111112111
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma delivery_order:
  all-traces
  "∀ A B m m2 #i #j.
    (((Sent( A, B, m ) @ #i) ∧ (Sent( A, B, m2 ) @ #j)) ∧ (#i < #j)) ⇒
    (∃ #k #l.
      ((Recv( A, B, m ) @ #k) ∧ (Recv( A, B, m2 ) @ #l)) ∧ (#k < #l))"
/*
guarded formula characterizing all counter-examples:
"∃ A B m m2 #i #j.
  (Sent( A, B, m ) @ #i) ∧ (Sent( A, B, m2 ) @ #j)
 ∧
  (#i < #j) ∧
  (∀ #k #l. (Recv( A, B, m ) @ #k) ∧ (Recv( A, B, m2 ) @ #l) ⇒ ¬(#k < #l))"
*/
simplify
solve( State_111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111,
                           lock, A, B, kEnc, kSign, m, seq
       ) ▶₀ #i )
  case eventSeqSentabseq_0_1111111111
  solve( State_111111111111( ~prog_1.1, ~prog_11111111.1,
                             ~prog_1111111111.1, lock, ~n.1, ~n.2, kEnc, kSign, m2, seq.1
         ) ▶₀ #j )
    case eventSeqSentabseq_0_1111111111
    solve( (¬(#vr < #vr.6))  ∥ (∃ dif. (seq.1 = (dif++seq))) )
      case case_1
      solve( (¬(#vr.6 < #vr))  ∥ (∃ dif. (seq = (dif++seq.1))) )
        case case_1
        solve( ((#vr.2 < #vr.8) ∧
                (∃ #t2.
                  (Unlock_0( '0', ~n, <~n.1, ~n.2> ) @ #t2)
                 ∧
                  (#vr.2 < #t2) ∧
                  (#t2 < #vr.8) ∧
                  (∀ #t0 pp. (Unlock( pp, ~n, <~n.1, ~n.2> ) @ #t0) ⇒ #t0 = #t2) ∧
                  (∀ pp lpp #t0.
                    (Lock( pp, lpp, <~n.1, ~n.2> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.2) ∨ (#t0 = #vr.2) ∨ (#t2 < #t0))) ∧
                  (∀ pp lpp #t0.
                    (Unlock( pp, lpp, <~n.1, ~n.2> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.2) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
               (#vr.8 < #vr.2)  ∥ (#vr.2 = #vr.8) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          by contradiction /* cyclic */
        next
          case case_3
          by contradiction /* cyclic */
        qed
      next
        case case_2
        solve( ((#vr.2 < #vr.8) ∧
                (∃ #t2.
                  (Unlock_0( '0', ~n, <~n.1, ~n.2> ) @ #t2)
                 ∧
                  (#vr.2 < #t2) ∧
                  (#t2 < #vr.8) ∧
                  (∀ #t0 pp. (Unlock( pp, ~n, <~n.1, ~n.2> ) @ #t0) ⇒ #t0 = #t2) ∧
                  (∀ pp lpp #t0.
                    (Lock( pp, lpp, <~n.1, ~n.2> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.2) ∨ (#t0 = #vr.2) ∨ (#t2 < #t0))) ∧
                  (∀ pp lpp #t0.
                    (Unlock( pp, lpp, <~n.1, ~n.2> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.2) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
               (#vr.8 < #vr.2)  ∥ (#vr.2 = #vr.8) )
          case case_1
          by contradiction /* cyclic */
        next
          case case_2
          by contradiction /* cyclic */
        qed
      qed
    next
      case case_2
      solve( (¬(#vr.6 < #vr))  ∥ (∃ dif.1. (seq = (dif++seq++dif.1))) )
        case case_1
        solve( ((#vr.2 < #vr.8) ∧
                (∃ #t2.
                  (Unlock_0( '0', ~n, <~n.1, ~n.2> ) @ #t2)
                 ∧
                  (#vr.2 < #t2) ∧
                  (#t2 < #vr.8) ∧
                  (∀ #t0 pp. (Unlock( pp, ~n, <~n.1, ~n.2> ) @ #t0) ⇒ #t0 = #t2) ∧
                  (∀ pp lpp #t0.
                    (Lock( pp, lpp, <~n.1, ~n.2> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.2) ∨ (#t0 = #vr.2) ∨ (#t2 < #t0))) ∧
                  (∀ pp lpp #t0.
                    (Unlock( pp, lpp, <~n.1, ~n.2> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.2) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
               (#vr.8 < #vr.2)  ∥ (#vr.2 = #vr.8) )
          case case_1
          solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.1 )
            case p_1_
            solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t.2 )
              case p_1_
              solve( State_11111111( ~prog_1.2, ~prog_11111111, a, b, kEnc.1, kSign.1
                     ) ▶₀ #t.3 )
                case p_1_1111111
                solve( State_11111111111111( $MH.1, $SH.1, $pad.1, ~prog_1.2,
                                             ~prog_11111111.3, ~prog_1111111111, lock, a, b, kEnc.1, kSign.1,
                                             m.1, seq.2
                       ) ▶₀ #t.3 )
                  case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                  solve( MID_Receiver( ~mid_1111111111111 ) ▶₃ #j.1 )
                    case MessageIDRule
                    solve( State_111111( ~prog_1, a.1, b.1, kEnc, kSign.1 ) ▶₀ #t.3 )
                      case p_1_
                      solve( State_111112( ~prog_1, a.1, b.1, kEnc, kSign.1 ) ▶₀ #t.3 )
                        case p_1_
                        solve( State_11111111( ~prog_1.2, ~prog_11111111.1, a.1, b.1, kEnc,
                                               kSign.1
                               ) ▶₀ #t.3 )
                          case p_1_1111111
                          solve( State_11111111111111( $MH.1, $SH.1, $pad.1, ~prog_1.2,
                                                       ~prog_11111111.2, ~prog_1111111111.1, lock.1, a.1, b.1,
                                                       kEnc, kSign.1, m, seq.1
                                 ) ▶₀ #t.4 )
                            case outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111
                            solve( MID_Receiver( ~mid_1111111111111.1 ) ▶₃ #j.2 )
                              case MessageIDRule
                              solve( State_111111( ~prog_1, a.2, b.2, kEnc, kSign.2 ) ▶₀ #t.5 )
                                case p_1_
                                solve( State_111112( ~prog_1, a.2, b.2, kEnc, kSign.2 ) ▶₀ #t.5 )
                                  case p_1_
                                  solve( State_111112111( ~prog_1.1, ~prog_11111211, a, b, ~n.3, kSign,
                                                          lock
                                         ) ▶₁ #j.1 )
                                    case lockba_0_11111211
                                    solve( State_111111( ~prog_1, a.1, b.1, kEnc, kSign.1 ) ▶₀ #t.5 )
                                      case p_1_
                                      solve( State_111112( ~prog_1, a.1, b.1, kEnc, kSign.1 ) ▶₀ #t.5 )
                                        case p_1_
                                        solve( State_11111111( ~prog_1.2, ~prog_11111111, a.1, b.1, kEnc,
                                                               kSign.1
                                               ) ▶₀ #t.5 )
                                          case p_1_1111111
                                          solve( State_111111( ~prog_1, a.1, b.1, kEnc, kSign.1 ) ▶₀ #t.5 )
                                            case p_1_
                                            solve( State_111112( ~prog_1, a.1, b.1, kEnc, kSign.1 ) ▶₀ #t.5 )
                                              case p_1_
                                              solve( State_111112111( ~prog_1.1, ~prog_11111211.1, a, b, ~n.3,
                                                                      kSign, lock
                                                     ) ▶₁ #j.2 )
                                                case lockba_0_11111211
                                                solve( ((#vr.12 < #vr.14) ∧
                                                        (∃ #t2.
                                                          (Unlock_1( '1', ~n.8, <~n.2, ~n.1> ) @ #t2)
                                                         ∧
                                                          (#vr.12 < #t2) ∧
                                                          (#t2 < #vr.14) ∧
                                                          (∀ #t0 pp.
                                                            (Unlock( pp, ~n.8, <~n.2, ~n.1> ) @ #t0)
                                                           ⇒
                                                            #t0 = #t2) ∧
                                                          (∀ pp lpp #t0.
                                                            (Lock( pp, lpp, <~n.2, ~n.1> ) @ #t0)
                                                           ⇒
                                                            ((#t0 < #vr.12) ∨ (#t0 = #vr.12) ∨ (#t2 < #t0))) ∧
                                                          (∀ pp lpp #t0.
                                                            (Unlock( pp, lpp, <~n.2, ~n.1> ) @ #t0)
                                                           ⇒
                                                            ((#t0 < #vr.12) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                                       (#vr.14 < #vr.12)  ∥ (#vr.12 = #vr.14) )
                                                  case case_1
                                                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                    case p_1_
                                                    solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1
                                                           ) ▶₀ #t.5 )
                                                      case p_1_
                                                      solve( State_11111111( ~prog_1.2, ~prog_11111111.1, a,
                                                                             b, kEnc.1, kSign.1
                                                             ) ▶₀ #t.5 )
                                                        case p_1_1111111
                                                        solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1
                                                               ) ▶₀ #t.5 )
                                                          case p_1_
                                                          solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1
                                                                 ) ▶₀ #t.5 )
                                                            case p_1_
                                                            solve( State_11111211( ~prog_1.2, ~prog_11111211,
                                                                                   a, b, kEnc.1, kSign.1
                                                                   ) ▶₀ #t.5 )
                                                              case p_1_1111121
                                                              solve( State_111111( ~prog_1, a, b, kEnc.1,
                                                                                   kSign.1
                                                                     ) ▶₀ #t.6 )
                                                                case p_1_
                                                                solve( State_111112( ~prog_1, a, b, kEnc.1,
                                                                                     kSign.1
                                                                       ) ▶₀ #t.6 )
                                                                  case p_1_
                                                                  solve( State_111111( ~prog_1, a, b, kEnc.1,
                                                                                       kSign.1
                                                                         ) ▶₀ #t.6 )
                                                                    case p_1_
                                                                    solve( State_111112( ~prog_1, a, b,
                                                                                         kEnc.1, kSign.1
                                                                           ) ▶₀ #t.6 )
                                                                      case p_1_
                                                                      solve( State_11111211( ~prog_1.2,
                                                                                             ~prog_11111211.2,
                                                                                             a, b, kEnc.1,
                                                                                             kSign.1
                                                                             ) ▶₀ #t.6 )
                                                                        case p_1_1111121
                                                                        solve( State_1111121111111( ~prog_1.1,
                                                                                                    ~prog_11111211.1,
                                                                                                    ~prog_1111121111.1,
                                                                                                    MH.1,
                                                                                                    SH.1,
                                                                                                    ~n.1,
                                                                                                    ~n.2,
                                                                                                    kEnc,
                                                                                                    kSign,
                                                                                                    ~n.8,
                                                                                                    pad.1,
                                                                                                    xmac, m,
                                                                                                    seq.1
                                                                               ) ▶₀ #t2.1 )
                                                                          case eventRecvabm_0_111112111111
                                                                          solve( State_111111( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t.7 )
                                                                            case p_1_
                                                                            solve( State_111112( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t.7 )
                                                                              case p_1_
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.7 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.7 )
                                                                                  case p_1_
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.7 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.7 )
                                                                                      case p_1_
                                                                                      solve( State_111111( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t.7 )
                                                                                        case p_1_
                                                                                        solve( State_111112( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t.7 )
                                                                                          case p_1_
                                                                                          solve( State_11111211( ~prog_1.1,
                                                                                                                 ~prog_11111211,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                 ) ▶₀ #t.7 )
                                                                                            case p_1_1111121
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.7 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.7 )
                                                                                                case p_1_
                                                                                                solve( (∃ #t.
                                                                                                         (ProgressTo_11111211111111( ~prog_1111121111
                                                                                                          ) @ #t))  ∥
                                                                                                       (∃ #t.
                                                                                                         (ProgressTo_11111211112( ~prog_1111121111
                                                                                                          ) @ #t)) )
                                                                                                  case case_1
                                                                                                  solve( State_1111121111111( ~prog_1.1,
                                                                                                                              ~prog_11111211.2,
                                                                                                                              ~prog_1111121111,
                                                                                                                              MH.2,
                                                                                                                              SH.2,
                                                                                                                              a,
                                                                                                                              b,
                                                                                                                              kEnc,
                                                                                                                              kSign,
                                                                                                                              lock,
                                                                                                                              pad.2,
                                                                                                                              xmac,
                                                                                                                              m,
                                                                                                                              seq.1
                                                                                                         ) ▶₀ #t.7 )
                                                                                                    case eventRecvabm_0_111112111111
                                                                                                    solve( State_111111( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t.7 )
                                                                                                      case p_1_
                                                                                                      solve( State_111112( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t.7 )
                                                                                                        case p_1_
                                                                                                        solve( State_11111211( ~prog_1.1,
                                                                                                                               ~prog_11111211,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                               ) ▶₀ #t.7 )
                                                                                                          case p_1_1111121
                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t.7 )
                                                                                                            case p_1_
                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t.7 )
                                                                                                              case p_1_
                                                                                                              solve( (∃ #t.
                                                                                                                       (ProgressTo_11111211111111( ~prog_1111121111.1
                                                                                                                        ) @ #t))  ∥
                                                                                                                     (∃ #t.
                                                                                                                       (ProgressTo_11111211112( ~prog_1111121111.1
                                                                                                                        ) @ #t)) )
                                                                                                                case case_1
                                                                                                                solve( State_1111121111111( ~prog_1.1,
                                                                                                                                            ~prog_11111211.2,
                                                                                                                                            ~prog_1111121111.1,
                                                                                                                                            MH.2,
                                                                                                                                            SH.2,
                                                                                                                                            a,
                                                                                                                                            b,
                                                                                                                                            kEnc,
                                                                                                                                            kSign,
                                                                                                                                            lock,
                                                                                                                                            pad.2,
                                                                                                                                            xmac,
                                                                                                                                            m,
                                                                                                                                            seq.1
                                                                                                                       ) ▶₀ #t.7 )
                                                                                                                  case eventRecvabm_0_111112111111
                                                                                                                  by contradiction
                                                                                                                     /*
                                                                                                                     from formulas
                                                                                                                     */
                                                                                                                qed
                                                                                                              next
                                                                                                                case case_2
                                                                                                                solve( State_1111121111( ~prog_1.1,
                                                                                                                                         ~prog_11111211.2,
                                                                                                                                         ~prog_1111121111.1,
                                                                                                                                         MH.2,
                                                                                                                                         SH.2,
                                                                                                                                         a,
                                                                                                                                         b,
                                                                                                                                         kEnc,
                                                                                                                                         kSign,
                                                                                                                                         lock,
                                                                                                                                         pad.2,
                                                                                                                                         xmac,
                                                                                                                                         m,
                                                                                                                                         seq.1
                                                                                                                       ) ▶₀ #t.7 )
                                                                                                                  case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                                  by contradiction
                                                                                                                     /*
                                                                                                                     from formulas
                                                                                                                     */
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                next
                                                                                                  case case_2
                                                                                                  by solve( State_1111121111( ~prog_1.1,
                                                                                                                              ~prog_11111211.2,
                                                                                                                              ~prog_1111121111,
                                                                                                                              MH.2,
                                                                                                                              SH.2,
                                                                                                                              a,
                                                                                                                              b,
                                                                                                                              kEnc,
                                                                                                                              kSign,
                                                                                                                              lock,
                                                                                                                              pad.2,
                                                                                                                              xmac,
                                                                                                                              m,
                                                                                                                              seq.1
                                                                                                            ) ▶₀ #t.7 )
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case case_2
                                                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t.5 )
                                                    case p_1_
                                                    solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1
                                                           ) ▶₀ #t.5 )
                                                      case p_1_
                                                      solve( State_11111111( ~prog_1.2, ~prog_11111111.1, a,
                                                                             b, kEnc.1, kSign.1
                                                             ) ▶₀ #t.5 )
                                                        case p_1_1111111
                                                        solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1
                                                               ) ▶₀ #t.5 )
                                                          case p_1_
                                                          solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1
                                                                 ) ▶₀ #t.5 )
                                                            case p_1_
                                                            solve( State_11111211( ~prog_1.2, ~prog_11111211,
                                                                                   a, b, kEnc.1, kSign.1
                                                                   ) ▶₀ #t.5 )
                                                              case p_1_1111121
                                                              solve( State_111111( ~prog_1, a, b, kEnc.1,
                                                                                   kSign.1
                                                                     ) ▶₀ #t.6 )
                                                                case p_1_
                                                                solve( State_111112( ~prog_1, a, b, kEnc.1,
                                                                                     kSign.1
                                                                       ) ▶₀ #t.6 )
                                                                  case p_1_
                                                                  solve( State_111111( ~prog_1, a, b, kEnc.1,
                                                                                       kSign.1
                                                                         ) ▶₀ #t.6 )
                                                                    case p_1_
                                                                    solve( State_111112( ~prog_1, a, b,
                                                                                         kEnc.1, kSign.1
                                                                           ) ▶₀ #t.6 )
                                                                      case p_1_
                                                                      solve( State_11111211( ~prog_1.2,
                                                                                             ~prog_11111211.2,
                                                                                             a, b, kEnc.1,
                                                                                             kSign.1
                                                                             ) ▶₀ #t.6 )
                                                                        case p_1_1111121
                                                                        solve( State_1111121111111( ~prog_1.1,
                                                                                                    ~prog_11111211.1,
                                                                                                    ~prog_1111121111.1,
                                                                                                    MH.1,
                                                                                                    SH.1,
                                                                                                    ~n.1,
                                                                                                    ~n.2,
                                                                                                    kEnc,
                                                                                                    kSign,
                                                                                                    ~n.9,
                                                                                                    pad.1,
                                                                                                    xmac, m,
                                                                                                    seq.1
                                                                               ) ▶₀ #t2.1 )
                                                                          case eventRecvabm_0_111112111111
                                                                          solve( State_111111( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t.7 )
                                                                            case p_1_
                                                                            solve( State_111112( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t.7 )
                                                                              case p_1_
                                                                              solve( State_111111( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t.7 )
                                                                                case p_1_
                                                                                solve( State_111112( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t.7 )
                                                                                  case p_1_
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t.7 )
                                                                                    case p_1_
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t.7 )
                                                                                      case p_1_
                                                                                      solve( State_111111( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t.7 )
                                                                                        case p_1_
                                                                                        solve( State_111112( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t.7 )
                                                                                          case p_1_
                                                                                          solve( State_11111211( ~prog_1.1,
                                                                                                                 ~prog_11111211.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                 ) ▶₀ #t.7 )
                                                                                            case p_1_1111121
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t.7 )
                                                                                              case p_1_
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t.7 )
                                                                                                case p_1_
                                                                                                solve( (∃ #t.
                                                                                                         (ProgressTo_11111211111111( ~prog_1111121111
                                                                                                          ) @ #t))  ∥
                                                                                                       (∃ #t.
                                                                                                         (ProgressTo_11111211112( ~prog_1111121111
                                                                                                          ) @ #t)) )
                                                                                                  case case_1
                                                                                                  by solve( State_1111121111111( ~prog_1.1,
                                                                                                                                 ~prog_11111211.2,
                                                                                                                                 ~prog_1111121111,
                                                                                                                                 MH.2,
                                                                                                                                 SH.2,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign,
                                                                                                                                 lock,
                                                                                                                                 pad.2,
                                                                                                                                 xmac,
                                                                                                                                 m,
                                                                                                                                 seq.1
                                                                                                            ) ▶₀ #t.7 )
                                                                                                next
                                                                                                  case case_2
                                                                                                  solve( State_1111121111( ~prog_1.1,
                                                                                                                           ~prog_11111211.2,
                                                                                                                           ~prog_1111121111,
                                                                                                                           MH.2,
                                                                                                                           SH.2,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign,
                                                                                                                           lock,
                                                                                                                           pad.2,
                                                                                                                           xmac,
                                                                                                                           m,
                                                                                                                           seq.1
                                                                                                         ) ▶₀ #t.7 )
                                                                                                    case inrMHSHsencseqmpadxmackEnc_0_111112111
                                                                                                    by contradiction
                                                                                                       /*
                                                                                                       from formulas
                                                                                                       */
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case case_2
          by contradiction /* cyclic */
        qed
      qed
    qed
  qed
qed



















rule (modulo E) MessageIDRule[color=#ffffff, process='!', issapicrule,
                              role='Process']:
   [ Fr( ~mid_ ) ] --> [ MID_Receiver( ~mid_ ), MID_Sender( ~mid_ ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Init[color=#ffffff, process='!', issapicrule,
                     role='Process']:
   [ ] --[ Init( ) ]-> [ !Semistate_1( ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) p_1_1111111[color=#804046, process='!', issapicrule,
                            role='A']:
   [
   Fr( ~prog_11111111 ),
   !Semistate_11111111( ~prog_1, a.1, b.1, kEnc.1, kSign.1 )
   ]
  --[ ProgressFrom_11111111( ~prog_11111111 ) ]->
   [ State_11111111( ~prog_1, ~prog_11111111, a.1, b.1, kEnc.1, kSign.1 ) ]

  /*
  rule (modulo AC) p_1_1111111[color=#804046, process='!', issapicrule,
                               role='A']:
     [ Fr( ~prog_11111111 ), !Semistate_11111111( ~prog_1, a, b, kEnc, kSign )
     ]
    --[ ProgressFrom_11111111( ~prog_11111111 ) ]->
     [ State_11111111( ~prog_1, ~prog_11111111, a, b, kEnc, kSign ) ]
  */

rule (modulo E) lockab_0_11111111[color=#804046,
                                  process='lock <a.1, b.1>;', issapicrule, role='A']:
   [
   State_11111111( ~prog_1, ~prog_11111111, a.1, b.1, kEnc.1, kSign.1 ),
   Fr( lock )
   ]
  --[
  ProgressTo_111111111( ~prog_11111111 ), Lock_0( '0', lock, <a.1, b.1> ),
  Lock( '0', lock, <a.1, b.1> )
  ]->
   [
   State_111111111( ~prog_1, ~prog_11111111, lock, a.1, b.1, kEnc.1, kSign.1
   )
   ]

  /*
  rule (modulo AC) lockab_0_11111111[color=#804046,
                                     process='lock <a.1, b.1>;', issapicrule, role='A']:
     [
     State_11111111( ~prog_1, ~prog_11111111, a, b, kEnc, kSign ), Fr( lock )
     ]
    --[
    ProgressTo_111111111( ~prog_11111111 ), Lock_0( '0', lock, <a, b> ),
    Lock( '0', lock, <a, b> )
    ]->
     [ State_111111111( ~prog_1, ~prog_11111111, lock, a, b, kEnc, kSign ) ]
  */

rule (modulo E) incseq_0_111111111[color=#804046,
                                   process='in('c',seq.1);', issapicrule, role='A']:
   [
   Fr( ~prog_1111111111 ),
   State_111111111( ~prog_1, ~prog_11111111, lock, a.1, b.1, kEnc.1, kSign.1
   ),
   In( <'c', seq.1> )
   ]
  --[
  ProgressFrom_1111111111( ~prog_1111111111 ), ChannelIn( <'c', seq.1> )
  ]->
   [
   State_1111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a.1,
                     b.1, kEnc.1, kSign.1, seq.1
   )
   ]

  /*
  rule (modulo AC) incseq_0_111111111[color=#804046,
                                      process='in('c',seq.1);', issapicrule, role='A']:
     [
     Fr( ~prog_1111111111 ),
     State_111111111( ~prog_1, ~prog_11111111, lock, a, b, kEnc, kSign ),
     In( <'c', seq> )
     ]
    --[ ProgressFrom_1111111111( ~prog_1111111111 ), ChannelIn( <'c', seq> )
    ]->
     [
     State_1111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a, b,
                       kEnc, kSign, seq
     )
     ]
  */

rule (modulo E) eventSeqSentabseq_0_1111111111[color=#804046,
                                               process='new m.1;', issapicrule, role='A']:
   [
   State_1111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a.1,
                     b.1, kEnc.1, kSign.1, seq.1
   ),
   Fr( m.1 )
   ]
  --[ Seq_Sent( a.1, b.1, seq.1 ) ]->
   [
   State_111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a.1,
                       b.1, kEnc.1, kSign.1, m.1, seq.1
   )
   ]

  /*
  rule (modulo AC) eventSeqSentabseq_0_1111111111[color=#804046,
                                                  process='new m.1;', issapicrule, role='A']:
     [
     State_1111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a, b,
                       kEnc, kSign, seq
     ),
     Fr( m )
     ]
    --[ Seq_Sent( a, b, seq ) ]->
     [
     State_111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a,
                         b, kEnc, kSign, m, seq
     )
     ]
  */

rule (modulo E) eventSentabm_0_111111111111[color=#804046,
                                            process='event Sent( a.1, b.1, m.1 );', issapicrule, role='A']:
   [
   State_111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a.1,
                       b.1, kEnc.1, kSign.1, m.1, seq.1
   )
   ]
  --[ Sent( a.1, b.1, m.1 ) ]->
   [
   State_1111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock,
                        a.1, b.1, kEnc.1, kSign.1, m.1, seq.1
   )
   ]

  /*
  rule (modulo AC) eventSentabm_0_111111111111[color=#804046,
                                               process='event Sent( a.1, b.1, m.1 );', issapicrule, role='A']:
     [
     State_111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a,
                         b, kEnc, kSign, m, seq
     )
     ]
    --[ Sent( a, b, m ) ]->
     [
     State_1111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a,
                          b, kEnc, kSign, m, seq
     )
     ]
  */

rule (modulo E) outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111[color=#804046,
                                                                           process='out('r',<$MH, $SH, 
 senc(<seq.1, m.1, $pad, mac(<$MH, $SH, seq.1, m.1, $pad>, kSign.1)
      >,
      kEnc.1)
>);',
                                                                           issapicrule, role='A']:
   [
   MID_Sender( ~mid_1111111111111 ),
   State_1111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock,
                        a.1, b.1, kEnc.1, kSign.1, m.1, seq.1
   )
   ]
  --[
  Send( ~mid_1111111111111,
        <$MH, $SH, 
         senc(<seq.1, m.1, $pad, mac(<$MH, $SH, seq.1, m.1, $pad>, kSign.1)>,
              kEnc.1)
        >
  )
  ]->
   [
   Out( <$MH, $SH, 
         senc(<seq.1, m.1, $pad, mac(<$MH, $SH, seq.1, m.1, $pad>, kSign.1)>,
              kEnc.1)
        >
   ),
   State_11111111111111( $MH, $SH, $pad, ~prog_1, ~prog_11111111,
                         ~prog_1111111111, lock, a.1, b.1, kEnc.1, kSign.1, m.1, seq.1
   )
   ]

  /*
  rule (modulo AC) outrMHSHsencseqmpadmacMHSHseqmpadkSignkEnc_0_1111111111111[color=#804046,
                                                                              process='out('r',<$MH, $SH, 
 senc(<seq.1, m.1, $pad, mac(<$MH, $SH, seq.1, m.1, $pad>, kSign.1)
      >,
      kEnc.1)
>);',
                                                                              issapicrule, role='A']:
     [
     MID_Sender( ~mid_1111111111111 ),
     State_1111111111111( ~prog_1, ~prog_11111111, ~prog_1111111111, lock, a,
                          b, kEnc, kSign, m, seq
     )
     ]
    --[
    Send( ~mid_1111111111111,
          <$MH, $SH, 
           senc(<seq, m, $pad, mac(<$MH, $SH, seq, m, $pad>, kSign)>, kEnc)>
    )
    ]->
     [
     Out( <$MH, $SH, 
           senc(<seq, m, $pad, mac(<$MH, $SH, seq, m, $pad>, kSign)>, kEnc)>
     ),
     State_11111111111111( $MH, $SH, $pad, ~prog_1, ~prog_11111111,
                           ~prog_1111111111, lock, a, b, kEnc, kSign, m, seq
     )
     ]
  */

rule (modulo E) unlockab_0_11111111111111[color=#804046, process='0',
                                          issapicrule, role='A']:
   [
   State_11111111111111( $MH, $SH, $pad, ~prog_1, ~prog_11111111,
                         ~prog_1111111111, lock, a.1, b.1, kEnc.1, kSign.1, m.1, seq.1
   )
   ]
  --[
  ProgressTo_111111111111111( ~prog_1111111111 ),
  Unlock_0( '0', lock, <a.1, b.1> ), Unlock( '0', lock, <a.1, b.1> )
  ]->
   [ ]

  /*
  rule (modulo AC) unlockab_0_11111111111111[color=#804046, process='0',
                                             issapicrule, role='A']:
     [
     State_11111111111111( $MH, $SH, $pad, ~prog_1, ~prog_11111111,
                           ~prog_1111111111, lock, a, b, kEnc, kSign, m, seq
     )
     ]
    --[
    ProgressTo_111111111111111( ~prog_1111111111 ),
    Unlock_0( '0', lock, <a, b> ), Unlock( '0', lock, <a, b> )
    ]->
     [ ]
  */

rule (modulo E) A_0_111111[color=#ffffff, process='0', issapicrule,
                           role='Process']:
   [ State_111111( ~prog_1, a.1, b.1, kEnc.1, kSign.1 ) ]
  --[ ProgressTo_1111111( ~prog_1 ) ]->
   [ !Semistate_11111111( ~prog_1, a.1, b.1, kEnc.1, kSign.1 ) ]

  /*
  rule (modulo AC) A_0_111111[color=#ffffff, process='0', issapicrule,
                              role='Process']:
     [ State_111111( ~prog_1, a, b, kEnc, kSign ) ]
    --[ ProgressTo_1111111( ~prog_1 ) ]->
     [ !Semistate_11111111( ~prog_1, a, b, kEnc, kSign ) ]
  */

rule (modulo E) p_1_[color=#ffffff, process='|', issapicrule,
                     role='Process']:
   [
   Fr( ~prog_1 ), !Semistate_1( ), Fr( a.1 ), Fr( b.1 ), Fr( kSign.1 ),
   Fr( kEnc.1 )
   ]
  --[ ProgressFrom_1( ~prog_1 ) ]->
   [
   State_111111( ~prog_1, a.1, b.1, kEnc.1, kSign.1 ),
   State_111112( ~prog_1, a.1, b.1, kEnc.1, kSign.1 )
   ]

  /*
  rule (modulo AC) p_1_[color=#ffffff, process='|', issapicrule,
                        role='Process']:
     [
     Fr( ~prog_1 ), !Semistate_1( ), Fr( a ), Fr( b ), Fr( kSign ), Fr( kEnc )
     ]
    --[ ProgressFrom_1( ~prog_1 ) ]->
     [
     State_111111( ~prog_1, a, b, kEnc, kSign ),
     State_111112( ~prog_1, a, b, kEnc, kSign )
     ]
  */

rule (modulo E) p_1_1111121[color=#628040, process='!', issapicrule,
                            role='B']:
   [
   Fr( ~prog_11111211 ),
   !Semistate_11111211( ~prog_1, a.1, b.1, kEnc.1, kSign.1 )
   ]
  --[ ProgressFrom_11111211( ~prog_11111211 ) ]->
   [ State_11111211( ~prog_1, ~prog_11111211, a.1, b.1, kEnc.1, kSign.1 ) ]

  /*
  rule (modulo AC) p_1_1111121[color=#628040, process='!', issapicrule,
                               role='B']:
     [ Fr( ~prog_11111211 ), !Semistate_11111211( ~prog_1, a, b, kEnc, kSign )
     ]
    --[ ProgressFrom_11111211( ~prog_11111211 ) ]->
     [ State_11111211( ~prog_1, ~prog_11111211, a, b, kEnc, kSign ) ]
  */

rule (modulo E) lockba_0_11111211[color=#628040,
                                  process='lock <b.1, a.1>;', issapicrule, role='B']:
   [
   State_11111211( ~prog_1, ~prog_11111211, a.1, b.1, kEnc.1, kSign.1 ),
   Fr( lock.1 )
   ]
  --[
  ProgressTo_111112111( ~prog_11111211 ),
  Lock_1( '1', lock.1, <b.1, a.1> ), Lock( '1', lock.1, <b.1, a.1> )
  ]->
   [
   State_111112111( ~prog_1, ~prog_11111211, a.1, b.1, kEnc.1, kSign.1,
                    lock.1
   )
   ]

  /*
  rule (modulo AC) lockba_0_11111211[color=#628040,
                                     process='lock <b.1, a.1>;', issapicrule, role='B']:
     [
     State_11111211( ~prog_1, ~prog_11111211, a, b, kEnc, kSign ), Fr( lock )
     ]
    --[
    ProgressTo_111112111( ~prog_11111211 ), Lock_1( '1', lock, <b, a> ),
    Lock( '1', lock, <b, a> )
    ]->
     [ State_111112111( ~prog_1, ~prog_11111211, a, b, kEnc, kSign, lock ) ]
  */

rule (modulo E) inrMHSHsencseqmpadxmackEnc_0_111112111[color=#628040,
                                                       process='in('r',<MH.1, SH.1, senc(<seq.2, m.2, pad.1, xmac.1>, =kEnc.1)>);',
                                                       issapicrule, role='B']:
   [
   Fr( ~prog_1111121111 ),
   State_111112111( ~prog_1, ~prog_11111211, a.1, b.1, kEnc.1, kSign.1,
                    lock.1
   ),
   In( <MH.1, SH.1, senc(<seq.2, m.2, pad.1, xmac.1>, kEnc.1)> ),
   MID_Receiver( ~mid_111112111 )
   ]
  --[
  ProgressFrom_1111121111( ~prog_1111121111 ),
  Receive( ~mid_111112111,
           <MH.1, SH.1, senc(<seq.2, m.2, pad.1, xmac.1>, kEnc.1)>
  )
  ]->
   [
   State_1111121111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH.1, SH.1,
                     a.1, b.1, kEnc.1, kSign.1, lock.1, pad.1, xmac.1, m.2, seq.2
   )
   ]

  /*
  rule (modulo AC) inrMHSHsencseqmpadxmackEnc_0_111112111[color=#628040,
                                                          process='in('r',<MH.1, SH.1, senc(<seq.2, m.2, pad.1, xmac.1>, =kEnc.1)>);',
                                                          issapicrule, role='B']:
     [
     Fr( ~prog_1111121111 ),
     State_111112111( ~prog_1, ~prog_11111211, a, b, kEnc, kSign, lock ),
     In( <MH, SH, senc(<seq, m, pad, xmac>, kEnc)> ),
     MID_Receiver( ~mid_111112111 )
     ]
    --[
    ProgressFrom_1111121111( ~prog_1111121111 ),
    Receive( ~mid_111112111, <MH, SH, senc(<seq, m, pad, xmac>, kEnc)> )
    ]->
     [
     State_1111121111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH, SH, a,
                       b, kEnc, kSign, lock, pad, xmac, m, seq
     )
     ]
  */

rule (modulo E) ifxmacmacMHSHseqmpadkSign_0_1111121111[color=#628040,
                                                       process='if xmac.1=mac(<MH.1, SH.1, seq.2, m.2, pad.1>, kSign.1)',
                                                       issapicrule, role='B']:
   [
   State_1111121111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH.1, SH.1,
                     a.1, b.1, kEnc.1, kSign.1, lock.1, pad.1, xmac.1, m.2, seq.2
   )
   ]
  --[ Pred_Eq( xmac.1, mac(<MH.1, SH.1, seq.2, m.2, pad.1>, kSign.1) ) ]->
   [
   State_11111211111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH.1, SH.1,
                      a.1, b.1, kEnc.1, kSign.1, lock.1, pad.1, xmac.1, m.2, seq.2
   )
   ]

  /*
  rule (modulo AC) ifxmacmacMHSHseqmpadkSign_0_1111121111[color=#628040,
                                                          process='if xmac.1=mac(<MH.1, SH.1, seq.2, m.2, pad.1>, kSign.1)',
                                                          issapicrule, role='B']:
     [
     State_1111121111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH, SH, a,
                       b, kEnc, kSign, lock, pad, xmac, m, seq
     )
     ]
    --[ Pred_Eq( xmac, mac(<MH, SH, seq, m, pad>, kSign) ) ]->
     [
     State_11111211111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH, SH, a,
                        b, kEnc, kSign, lock, pad, xmac, m, seq
     )
     ]
  */

rule (modulo E) eventSeqRecvabseq_0_11111211111[color=#628040,
                                                process='event Seq_Recv( a.1, b.1, seq.2 );', issapicrule,
                                                role='B']:
   [
   State_11111211111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH.1, SH.1,
                      a.1, b.1, kEnc.1, kSign.1, lock.1, pad.1, xmac.1, m.2, seq.2
   )
   ]
  --[ Seq_Recv( a.1, b.1, seq.2 ) ]->
   [
   State_111112111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH.1,
                       SH.1, a.1, b.1, kEnc.1, kSign.1, lock.1, pad.1, xmac.1, m.2, seq.2
   )
   ]

  /*
  rule (modulo AC) eventSeqRecvabseq_0_11111211111[color=#628040,
                                                   process='event Seq_Recv( a.1, b.1, seq.2 );', issapicrule,
                                                   role='B']:
     [
     State_11111211111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH, SH, a,
                        b, kEnc, kSign, lock, pad, xmac, m, seq
     )
     ]
    --[ Seq_Recv( a, b, seq ) ]->
     [
     State_111112111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH, SH, a,
                         b, kEnc, kSign, lock, pad, xmac, m, seq
     )
     ]
  */

rule (modulo E) eventRecvabm_0_111112111111[color=#628040,
                                            process='event Recv( a.1, b.1, m.2 );', issapicrule, role='B']:
   [
   State_111112111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH.1,
                       SH.1, a.1, b.1, kEnc.1, kSign.1, lock.1, pad.1, xmac.1, m.2, seq.2
   )
   ]
  --[ Recv( a.1, b.1, m.2 ) ]->
   [
   State_1111121111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH.1,
                        SH.1, a.1, b.1, kEnc.1, kSign.1, lock.1, pad.1, xmac.1, m.2, seq.2
   )
   ]

  /*
  rule (modulo AC) eventRecvabm_0_111112111111[color=#628040,
                                               process='event Recv( a.1, b.1, m.2 );', issapicrule, role='B']:
     [
     State_111112111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH, SH, a,
                         b, kEnc, kSign, lock, pad, xmac, m, seq
     )
     ]
    --[ Recv( a, b, m ) ]->
     [
     State_1111121111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH, SH,
                          a, b, kEnc, kSign, lock, pad, xmac, m, seq
     )
     ]
  */

rule (modulo E) unlockba_0_1111121111111[color=#628040, process='0',
                                         issapicrule, role='B']:
   [
   State_1111121111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH.1,
                        SH.1, a.1, b.1, kEnc.1, kSign.1, lock.1, pad.1, xmac.1, m.2, seq.2
   )
   ]
  --[
  ProgressTo_11111211111111( ~prog_1111121111 ),
  Unlock_1( '1', lock.1, <b.1, a.1> ), Unlock( '1', lock.1, <b.1, a.1> )
  ]->
   [ ]

  /*
  rule (modulo AC) unlockba_0_1111121111111[color=#628040, process='0',
                                            issapicrule, role='B']:
     [
     State_1111121111111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH, SH,
                          a, b, kEnc, kSign, lock, pad, xmac, m, seq
     )
     ]
    --[
    ProgressTo_11111211111111( ~prog_1111121111 ),
    Unlock_1( '1', lock, <b, a> ), Unlock( '1', lock, <b, a> )
    ]->
     [ ]
  */

rule (modulo E) ifxmacmacMHSHseqmpadkSign_1_1111121111[color=#628040,
                                                       process='0', issapicrule, role='B']:
   [
   State_1111121111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH.1, SH.1,
                     a.1, b.1, kEnc.1, kSign.1, lock.1, pad.1, xmac.1, m.2, seq.2
   )
   ]
  --[
  ProgressTo_11111211112( ~prog_1111121111 ),
  Pred_Not_Eq( xmac.1, mac(<MH.1, SH.1, seq.2, m.2, pad.1>, kSign.1) )
  ]->
   [ ]

  /*
  rule (modulo AC) ifxmacmacMHSHseqmpadkSign_1_1111121111[color=#628040,
                                                          process='0', issapicrule, role='B']:
     [
     State_1111121111( ~prog_1, ~prog_11111211, ~prog_1111121111, MH, SH, a,
                       b, kEnc, kSign, lock, pad, xmac, m, seq
     )
     ]
    --[
    ProgressTo_11111211112( ~prog_1111121111 ),
    Pred_Not_Eq( xmac, mac(<MH, SH, seq, m, pad>, kSign) )
    ]->
     [ ]
  */

rule (modulo E) B_0_111112[color=#ffffff, process='0', issapicrule,
                           role='Process']:
   [ State_111112( ~prog_1, a.1, b.1, kEnc.1, kSign.1 ) ]
  --[ ProgressTo_1111121( ~prog_1 ) ]->
   [ !Semistate_11111211( ~prog_1, a.1, b.1, kEnc.1, kSign.1 ) ]

  /*
  rule (modulo AC) B_0_111112[color=#ffffff, process='0', issapicrule,
                              role='Process']:
     [ State_111112( ~prog_1, a, b, kEnc, kSign ) ]
    --[ ProgressTo_1111121( ~prog_1 ) ]->
     [ !Semistate_11111211( ~prog_1, a, b, kEnc, kSign ) ]
  */

restriction predicate_eq:
  "∀ #i a b. (Pred_Eq( a, b ) @ #i) ⇒ (a = b)"
  // safety formula

restriction predicate_not_eq:
  "∀ #i a b. (Pred_Not_Eq( a, b ) @ #i) ⇒ (¬(a = b))"
  // safety formula

restriction single_session:
  "∀ #i #j. ((Init( ) @ #i) ∧ (Init( ) @ #j)) ⇒ (#i = #j)"
  // safety formula

restriction locking_0:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_0( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_1:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_1( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction Progress_1_to_1111111:
  "∀ prog_1 #t.
    (ProgressFrom_1( prog_1 ) @ #t) ⇒
    (∃ #t.1. ProgressTo_1111111( prog_1 ) @ #t.1)"

restriction Progress_1_to_1111121:
  "∀ prog_1 #t.
    (ProgressFrom_1( prog_1 ) @ #t) ⇒
    (∃ #t.1. ProgressTo_1111121( prog_1 ) @ #t.1)"

restriction Progress_11111111_to_111111111:
  "∀ prog_11111111 #t.
    (ProgressFrom_11111111( prog_11111111 ) @ #t) ⇒
    (∃ #t.1. ProgressTo_111111111( prog_11111111 ) @ #t.1)"

restriction Progress_1111111111_to_111111111111111:
  "∀ prog_1111111111 #t.
    (ProgressFrom_1111111111( prog_1111111111 ) @ #t) ⇒
    (∃ #t.1. ProgressTo_111111111111111( prog_1111111111 ) @ #t.1)"

restriction Progress_11111211_to_111112111:
  "∀ prog_11111211 #t.
    (ProgressFrom_11111211( prog_11111211 ) @ #t) ⇒
    (∃ #t.1. ProgressTo_111112111( prog_11111211 ) @ #t.1)"

restriction Progress_1111121111_to_11111211111111_or_11111211112:
  "∀ prog_1111121111 #t.
    (ProgressFrom_1111121111( prog_1111121111 ) @ #t) ⇒
    ((∃ #t.1. ProgressTo_11111211111111( prog_1111121111 ) @ #t.1) ∨
     (∃ #t.1. ProgressTo_11111211112( prog_1111121111 ) @ #t.1))"

restriction progressInit:
  "∃ #t. Init( ) @ #t"

restriction reliable:
  "∀ #i x y.
    (Send( x, y ) @ #i) ⇒ (∃ #j. (Receive( x, y ) @ #j) ∧ (#i < #j))"

/*
WARNING: the following wellformedness checks failed!

Wellformedness-error in Process
  There is an unlock that cannot be matched with a lock.

Derivation Checks
=================

  Derivation checks timed out.
  Use --derivcheck-timeout=INT to configure timeout.
  Set to 0 to deactivate for no timeout.
*/

/*
Generated from:
Tamarin version 1.11.0
Maude version 3.4
Git revision: b954f6565e030d682d7951db74b7033939ef638b (with uncommited changes), branch: develop
Compiled at: 2025-06-06 08:30:52.256236371 UTC
*/

end
/* Output

==============================================================================
summary of summaries:

analyzed: examples/sapic/fast/SCADA/opc_ua_secure_conversation.spthy

  output:          examples/sapic/fast/SCADA/opc_ua_secure_conversation.spthy.tmp
  processing time: 87.57s
  
  WARNING: 2 wellformedness check failed!
           The analysis results might be wrong!
  
  Executable (exists-trace): verified (36 steps)
  all_received_were_sent (all-traces): verified (18 steps)
  all_received_were_sent_injective (all-traces): verified (168 steps)
  order (all-traces): verified (812 steps)
  delivery_wo_order (all-traces): verified (25 steps)
  delivery_order (all-traces): verified (98 steps)

==============================================================================
*/
